!function(){function e(e,t,o,n){Object.defineProperty(e,t,{get:o,set:n,enumerable:!0,configurable:!0})}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},o={},n={},r=t.parcelRequire94c2;null==r&&((r=function(e){if(e in o)return o[e].exports;if(e in n){var t=n[e];delete n[e];var r={id:e,exports:{}};return o[e]=r,t.call(r.exports,r,r.exports),r.exports}var s=Error("Cannot find module '"+e+"'");throw s.code="MODULE_NOT_FOUND",s}).register=function(e,t){n[e]=t},t.parcelRequire94c2=r);var s=r.register;s("jHnDr",function(t,o){e(t.exports,"register",function(){return n},function(e){return n=e}),e(t.exports,"resolve",function(){return r},function(e){return r=e});var n,r,s=new Map;n=function(e,t){for(var o=0;o<t.length-1;o+=2)s.set(t[o],{baseUrl:e,path:t[o+1]})},r=function(e){var t=s.get(e);if(null==t)throw Error("Could not resolve bundle with id "+e);return new URL(t.path,t.baseUrl).toString()}}),s("2372k",function(t,o){e(t.exports,"getBundleURL",function(){return n},function(e){return n=e});var n,r={};n=function(e){var t=r[e];return t||(t=function(){try{throw Error()}catch(t){var e=(""+t.stack).match(/(https?|file|ftp|(chrome|moz|safari-web)-extension):\/\/[^)\n]+/g);if(e)return(""+e[2]).replace(/^((?:https?|file|ftp|(chrome|moz|safari-web)-extension):\/\/.+)\/[^/]+$/,"$1")+"/"}return"/"}(),r[e]=t),t}}),s("aQK74",function(t,o){e(t.exports,"sendAnalyticsToExternalSource",function(){return f}),e(t.exports,"setImpressionByPublishId",function(){return N}),e(t.exports,"registerSiteActivityListenerIfNeeded",function(){return _}),e(t.exports,"sendPageVisitEvent",function(){return O});var n=r("50h3S"),s=r("8ptJJ"),i=r("kCbDV"),a=r("bvKjB"),l=r("93NPo"),d=r("dNsZ9"),c=r("tZRsn"),u=r("i1NbZ"),p=r("kK0IS"),E=r("eSOI5"),h=r("6QfcD");let g=e=>`tolstoy${(0,l.uppercaseFirstChar)(e)}`,f=e=>{(0,l.verifyUserConsent)()&&(T(e),S(e))},S=e=>{let{data:{name:t,text:o,facebookAnalyticsID:r,playlist:s,collectInfoType:i}}=e;if(!window.fbq||!r||!s)return;let a=`tolstoy-${s}`;switch(t){case n.PLAYER_EVENT_NAMES.sessionStart:y(r,`${a}-click`,{value:"Start Tolstoy"});break;case n.PLAYER_EVENT_NAMES.clickCta:y(r,`${a}-click`,{value:o});break;case n.PLAYER_EVENT_NAMES.submitInput:y(r,`${a}-input`,{value:o});break;case n.PLAYER_EVENT_NAMES.collectInfo:y(r,`${a}-${n.PLAYER_EVENTS.collectInfo}`,{value:i});break;case n.PLAYER_EVENT_NAMES.videoResponse:y(r,`${a}-${n.PLAYER_EVENTS.videoResponse}`);break;case n.PLAYER_EVENT_NAMES.imageResponse:y(r,`${a}-${n.PLAYER_EVENTS.imageResponse}`);break;case n.PLAYER_EVENT_NAMES.audioResponse:y(r,`${a}-${n.PLAYER_EVENTS.audioResponse}`);break;case n.PLAYER_EVENTS.sessionEnd:y(r,`${a}-${n.PLAYER_EVENTS.sessionEnd}`)}},y=(e,t,o)=>{window.fbq("trackSingleCustom",e,t,o)},T=e=>{let{data:{name:t,text:o,googleAnalyticsID:r,playlist:s,collectInfoType:i,productNames:l,totalTime:d,videoName:c,type:u,direction:p}}=e;if(!window.gtag&&!window.dataLayer&&!window.ga||!r||!s)return;let E=`tolstoy-${s}`;switch(t){case a.EVENT_NAMES.pageView:break;case n.PLAYER_EVENTS.sessionStart:case n.PLAYER_EVENT_NAMES.sessionStart:m(r,E,n.PLAYER_EVENT_NAMES.sessionStart),m(r,E,"click","Start Tolstoy");break;case n.PLAYER_EVENT_NAMES.clickCta:m(r,E,t,o);break;case n.PLAYER_EVENT_NAMES.collectInfo:m(r,E,t,i);break;case n.PLAYER_EVENT_NAMES.submitInput:case n.PLAYER_EVENT_NAMES.imageResponse:case n.PLAYER_EVENT_NAMES.audioResponse:case n.PLAYER_EVENT_NAMES.videoResponse:case n.PLAYER_EVENT_NAMES.sessionEnd:m(r,E,t);break;case a.EVENT_NAMES.tolstoyModalClose:m(r,E,a.EVENT_NAMES.tolstoyModalClose,d);break;case a.EVENT_NAMES.videoLoaded:l&&m(r,E,"tolstoyVideoLoaded-products",l),m(r,E,"tolstoyVideoLoaded-videoName",c);break;case a.EVENT_NAMES.feedProductModalOpen:case a.EVENT_NAMES.feedProductModalClose:case a.EVENT_NAMES.clickViewProduct:case a.EVENT_NAMES.openProductPageClick:m(r,E,g(t),l);break;case a.EVENT_NAMES.feedPlay:case a.EVENT_NAMES.feedPause:case a.EVENT_NAMES.videoMuted:case a.EVENT_NAMES.videoUnmuted:case a.EVENT_NAMES.videoWatched:m(r,E,g(t),c);break;case a.EVENT_NAMES.openShareLink:m(r,E,g("openShareLink"),u);break;case a.EVENT_NAMES.feedNavigationArrowClick:case a.EVENT_NAMES.feedScroll:m(r,E,g(t),p);break;default:m(r,E,g(t),o)}},m=(e,t,o,n)=>{(0,l.verifyUserConsent)()&&(window.gtag?window.gtag("event",o,{event_category:t,event_label:n,send_to:e}):window.dataLayer&&window.dataLayer.push({event:o,event_category:t,event_label:n,send_to:e}))},I={},N=(e,t)=>{I[e]=I[e]||t},w=!1,_=()=>{if(!w)try{let e=(0,h.getAppKey)();A({appKey:e}),w=!0}catch(e){console.error(e),window.tolstoyCaptureError?.(e)}},A=({appKey:e}={})=>{let t=0,o=!1;if((0,E.setNotVisibileOpenedTolstoyPublishId)(null),!(0,d.validateUUID)(e))return;let n=({now:n,performanceNow:r})=>{o=!1;let s=(0,E.getTolstoysActivity)();R(n,s),s=(0,E.getTolstoysActivity)();let a=Math.round(r-t),l=(0,E.getSessionUniqueId)(),d=b(s),c=window.location.href.split("?")[0],h=(0,u.getCurrentPageProductId)(),g={appKey:e,sessionUniqueId:l,timestamp:new Date().toISOString(),anonymousId:(0,E.getAndSetAnonymousId)(),storeUrl:window.Shopify?.shop,siteActivity:d,eventName:i.SITE_ACTIVITY_EVENT_NAME,timeOnPage:a,pageUrl:c,currentPageProductId:h};(0,p.createSiteActivityEvent)(g),o=!0,(0,E.clearTolstoyActivity)()};document.addEventListener("visibilitychange",()=>{try{let e=Date.now(),r=window.performance.now();"visible"===document.visibilityState&&(t=r,o=!1,L(e)),"hidden"!==document.visibilityState||o||n({now:e,performanceNow:r})}catch(e){console.error(e),window.tolstoyCaptureError?.(e)}}),window.addEventListener("beforeunload",()=>{if(!o)try{let e=Date.now(),t=window.performance.now();n({now:e,performanceNow:t})}catch(e){console.error(e),window.tolstoyCaptureError?.(e)}})},b=e=>{let t={};for(let[o,n]of Object.entries(I)){let r=e[o];r?.length||t[o]||(t[o]={activity:{},totalTime:0,impression:n});let s=v({publishId:o,activities:r}),i=0;for(let e of Object.values(s))i+=e;t[o]={activity:s,totalTime:i,impression:n}}return t},v=({publishId:e,activities:t})=>{if(!e||!t?.length)return{};let o=Date.now(),n={},r={};for(let{timeStamp:e,type:o,sessionId:s}of t)r[s]=r[s]||0,void 0===n[s]&&(n[s]=!1),(0,c.getIsActiveWidgetEvent)(o)&&!n[s]&&(n[s]=!0,r[s]-=e),(0,c.getIsInactiveWidgetEvent)(o)&&n[s]&&(n[s]=!1,r[s]+=e);for(let[e,t]of Object.entries(n))t&&(r[e]+=o),(r[e]<=0||r[e]>864e5)&&delete r[e];return r},C=e=>Object.entries(e).find(([e,t])=>{if(0===t.length)return;let o=t[t.length-1].type;return c.getIsActiveWidgetEvent(o)})?.[0],L=e=>{let t=(0,E.getNotVisibleOpenedTolstoyPublishId)(),o=(0,E.getSessionId)();t&&o&&((0,E.pushTolstoyActivity)({publishId:t,timeStamp:e,type:s.WIDGET_MESSAGES_EVENTS.OPEN,sessionId:o}),(0,E.setNotVisibileOpenedTolstoyPublishId)(null))},R=(e,t)=>{let o=C(t),n=(0,E.getSessionId)();o&&n&&((0,E.pushTolstoyActivity)({publishId:o,timeStamp:e,type:s.WIDGET_MESSAGES_EVENTS.CLOSE,sessionId:n}),(0,E.setNotVisibileOpenedTolstoyPublishId)(o))},O=()=>{let e=(0,h.getAppKey)();if(!e)return;let t=window.location.href.split("?")[0],o=(0,u.getCurrentPageProductId)(),n={appKey:e,sessionUniqueId:(0,E.getSessionUniqueId)(),createdAt:new Date().toISOString(),anonymousId:(0,E.getAndSetAnonymousId)(),appUrl:window.Shopify?.shop,eventName:i.PAGE_VISIT_EVENT_NAME,parentUrl:t,currentPageProductId:o};(0,p.createPageVisitEvent)(n)}}),s("50h3S",function(t,o){e(t.exports,"PLAYER_EVENTS",function(){return n}),e(t.exports,"PLAYER_EVENT_NAMES",function(){return r});let n={pageView:"pageView",sessionStart:"sessionStart",sessionEnd:"sessionEnd",videoPause:"videoPause",videoStart:"videoStart",videoResume:"videoResume",videoReplay:"videoReplay",clickCta:"clickCta",submitInput:"submitInput",collectInfo:"collectInfo",videoResponse:"videoResponse",audioResponse:"audioResponse",imageResponse:"imageResponse",tolstoyClick:"tolstoyClick",chapterSelected:"chapterSelected",chapterPickerOpened:"chapterPickerOpened",videoSeeked:"videoSeeked",shareClick:"shareClick",quizResult:"quizResult",autoplayStart:"autoplayStart"},r={sessionStart:"tolstoyStarted",sessionEnd:"tolstoyReachedEnd",clickCta:"tolstoyAnswerClicked",submitInput:"tolstoyInputSubmit",collectInfo:"tolstoyLeadFormSubmit",videoResponse:"tolstoyVideoSubmit",audioResponse:"tolstoyAudioSubmit",imageResponse:"tolstoyImageSubmit",openGorgias:"tolstoyOpenGorgias",hideGorgias:"tolstoyHideGorgias",openIntercom:"tolstoyOpenIntercom",hideIntercom:"tolstoyHideIntercom",openTawkTo:"tolstoyOpenTawkTo",hideTawkTo:"tolstoyHideTawkTo",openLiveChat:"tolstoyOpenLiveChat",hideLiveChat:"tolstoyHideLiveChat",openHubSpot:"tolstoyOpenHubSpot",hideHubSpot:"tolstoyHideHubSpot",openHelpScout:"tolstoyOpenHelpScout",hideHelpScout:"tolstoyHideHelpScout",openDrift:"tolstoyOpenDrift",hideDrift:"tolstoyHideDrift",openZendesk:"tolstoyOpenZendesk",hideZendesk:"tolstoyHideZendesk"}}),s("8ptJJ",function(t,o){e(t.exports,"TOLSTOY_ESCAPE_KEY_PRESSED_MESSAGE",function(){return n}),e(t.exports,"TOLSTOY_WATCHED_PRODUCT_IDS_MESSAGE",function(){return r}),e(t.exports,"SHOW_FEED_PRODUCT_MODAL_MESSAGE",function(){return s}),e(t.exports,"WIDGETS_MESSAGES",function(){return i}),e(t.exports,"SHOW_FEED_CART_MOBILE_MESSAGE",function(){return a}),e(t.exports,"TOLSTOY_MOVE_TO_URL",function(){return l}),e(t.exports,"TOLSTOY_CLOSE_MODAL_MESSAGE",function(){return d}),e(t.exports,"TOLSTOY_PLAYER_READY_MESSAGE",function(){return c}),e(t.exports,"FOCUS_CLOSE_BUTTON_MESSAGE",function(){return u}),e(t.exports,"WIDGET_MESSAGES_EVENTS",function(){return p}),e(t.exports,"ACTIVE_WIDGET_MESSAGES_EVENTS",function(){return E}),e(t.exports,"INACTIVE_WIDGET_MESSAGES_EVENTS",function(){return h}),e(t.exports,"PRE_CONFIG_MESSAGES",function(){return g}),e(t.exports,"RECHARGE_MESSAGING",function(){return f}),e(t.exports,"RECHARGE_WIDGET_DATA_MESSAGE",function(){return S}),e(t.exports,"REQUEST_RECHARGE_WIDGET_DATA_MESSAGE",function(){return y}),e(t.exports,"REQUEST_RECHARGE_ADD_TO_CART_MESSAGE",function(){return T});let n="tolstoyEscapeKeyPressed",r="tolstoyWatchedProductIds",s="showFeedProductModal",i="tolstoyWidgets",a="showFeedCartMobile",l="tolstoyMoveToUrl",d="tolstoyCloseModalMessage",c="tolstoyPlayerReady",u="focusCloseButton",p={OPEN:"open",CLOSE:"close",PLAY:"play",PAUSE:"pause"},E=[p.OPEN,p.PLAY],h=[p.CLOSE,p.PAUSE],g={ready:"tolstoyPreConfigMessengerReady",vodAssetIds:"tolstoyVodAssetIds"},f="rechargeMessaging",S="tolstoyRechargeWidgetData",y="tolstoyRequestRechargeWidgetData",T="tolstoyRequestRechargeAddToCart"}),s("kCbDV",function(t,o){e(t.exports,"CAROUSEL_EMBED_WIDGET",function(){return c}),e(t.exports,"IN_TILE_CAROUSEL_EMBED_WIDGET",function(){return u}),e(t.exports,"BUBBLE_WIDGET",function(){return p}),e(t.exports,"STORY_EMBED_WIDGET",function(){return E}),e(t.exports,"EMBED_WIDGET",function(){return h}),e(t.exports,"ON_YOU_WIDGET",function(){return g}),e(t.exports,"TILE_EMBED_WIDGET",function(){return f}),e(t.exports,"CENTERED_MODAL_WIDGET",function(){return S}),e(t.exports,"COLLECTION_TILE_EMBED_WIDGET",function(){return y}),e(t.exports,"COLLECTION_PAGE_TILE_EMBED_WIDGET",function(){return T}),e(t.exports,"STOP_SHOWING_WIDGET_TO",function(){return m}),e(t.exports,"EMBED_WIDGETS_CLASSNAMES",function(){return I}),e(t.exports,"SITE_ACTIVITY_EVENT_NAME",function(){return N}),e(t.exports,"PAGE_VISIT_EVENT_NAME",function(){return w}),e(t.exports,"DOM_EXCEPTION_ERRORS",function(){return _}),e(t.exports,"DEFAULT_CART_QUANTITY",function(){return A}),e(t.exports,"WIDGET_SCRIPT_PARAMETERS",function(){return b}),e(t.exports,"URL_PARAMETERS",function(){return v}),e(t.exports,"PLACEHOLDER_PRODUCT_ID",function(){return C}),e(t.exports,"CAROUSEL_CREATOR_PROFILE_LINK_POSITION",function(){return L});var n=r("iG8TK"),s=r("hRKjm"),i=r("99pD6"),a=r("lPPKE"),l=r("4lhba"),d=r("fgRdL");let c="carousel",u="inTileCarousel",p="bubble",E="stories",h="embed",g="onYou",f="tile",S="centeredModal",y="collectionTile",T="collectionPageTile",m={clickedX:"stopShowingWidgetToClickedX",viewed:"stopShowingWidgetToViewed"},I={[c]:n.PUBLIC_CLASSES.carousel,[E]:i.PUBLIC_CLASSES.story,[h]:s.PUBLIC_CLASSES.embed,[f]:a.PUBLIC_CLASSES.tile,[y]:l.PUBLIC_CLASSES.collectionTile,[T]:d.PUBLIC_CLASS},N="siteActivity",w="pageVisit",_={notAllowedError:"NotAllowedError",abortError:"AbortError"},A=1,b={shop:"shop",appKey:"app-key",productId:"product-id",shouldUseCache:"should-use-cache",cacheVersion:"cache-version"},v={tolstoyAutoOpen:"tolstoyAutoOpen",tolstoyAutoOpenOnYou:"tolstoyAutoOpenOnYou",tolstoyStartVideo:"tolstoyStartVideo",tolstoyMoneyFormat:"tolstoyMoneyFormat"},C="PRODUCT_ID",L={TOP:"top",BOTTOM:"bottom"}}),s("iG8TK",function(t,o){e(t.exports,"EMBED_CAROUSEL_MOTION",function(){return n}),e(t.exports,"CAROUSEL_TILE_NAME_LOCATION_TYPES",function(){return r}),e(t.exports,"PUBLIC_CLASSES",function(){return s}),e(t.exports,"MAX_TILE_NUMBER",function(){return i}),e(t.exports,"MIN_TILE_NUMBER",function(){return a}),e(t.exports,"MIN_WIDTH_FOR_TILE",function(){return l}),e(t.exports,"DEFAULT_DOT_OPACITY",function(){return d}),e(t.exports,"TILE_NAME_HEIGHT",function(){return c}),e(t.exports,"SPACING_HORIZONTAL",function(){return u}),e(t.exports,"DEFAULT_TILE_HEIGHT",function(){return p}),e(t.exports,"CAROUSEL_TYPE",function(){return E}),e(t.exports,"SPOTLIGHT_CAROUSEL_CONTENT_TILE_TYPE",function(){return h}),e(t.exports,"CAROUSEL_TITLE",function(){return g});let n={static:"static",dynamic:"dynamic",hoverOver:"hoverOver"},r={under:"under",over:"over"},s={carousel:"tolstoy-carousel",carouselContainer:"tolstoy-carousel-container",title:"tolstoy-carousel-title",videoCarouselContainer:"tolstoy-video-carousel-container",previousButton:"tolstoy-previous-button",nextButton:"tolstoy-next-button",arrowsContainer:"tolstoy-carousel-arrows-container",videosContainer:"tolstoy-carousel-videos-container",videoContainer:"tolstoy-carousel-video-container",video:"tolstoy-carousel-video",image:"tolstoy-carousel-image",dotsContainer:"tolstoy-dots-container",dot:"tolstoy-dot",playButtonContainer:"tolstoy-play-button-container",controlsContainer:"tolstoy-carousel-controls-container",expandButton:"tolstoy-carousel-expand-button",muteButton:"tolstoy-carousel-mute-button",playButton:"tolstoy-carousel-play-button",tileContainer:"tolstoy-carousel-tile-container",tile:"tolstoy-carousel-tile",centerTile:"tolstoy-carousel-center-tile",tileNameContainer:"tolstoy-tile-name-container",tileNameText:"tolstoy-carousel-tile-name-text",arrowButtonContainer:"tolstoy-carousel-arrow-button-container",arrowButton:"tolstoy-carousel-arrow-button",tileNameHeightPlaceholder:"tolstoy-tile-name-height-placeholder",productTile:"tolstoy-product-tile",productContent:"tolstoy-product-content",productTileImage:"tolstoy-product-tile-image",productTileTitle:"tolstoy-product-tile-title",tileText:"tolstoy-tile-text",variantTile:"tolstoy-product-variant-tile",variantTileIcon:"tolstoy-product-variant-tile-icon",variantTileTitle:"tolstoy-product-variant-tile-title",productTilePrice:"tolstoy-product-tile-price",productTileSubtitle:"tolstoy-product-tile-subtitle",productTileButton:"tolstoy-product-tile-button",productTileArrow:"tolstoy-product-tile-arrow",productTileFallback:"tolstoy-product-tile-fallback",descriptionTile:"tolstoy-description-tile",descriptionTileContent:"tolstoy-description-tile-content",descriptionTileButton:"tolstoy-description-tile-button"},i=6,a=2,l=80,d=.3,c=80,u=12,p=416,E={DEFAULT:"default",SPOTLIGHT:"spotlight"},h={product:"product",videoName:"videoName",none:"none"},g={shoppableVideoCarousel:"Shoppable Video Carousel",viewProduct:"View Product"}}),s("hRKjm",function(t,o){e(t.exports,"PUBLIC_CLASSES",function(){return n}),e(t.exports,"ASPECT_RATIO_9_16",function(){return r});let n={embed:"tolstoy-embed",iframe:"tolstoy-embed-iframe",videoPreview:"tolstoy-embed-video-preview",videoContainer:"tolstoy-embed-video-container",playButtonContainer:"tolstoy-embed-play-button-container",startText:"tolstoy-embed-start-text",startButtonContainer:"tolstoy-embed-start-button-container",startButton:"tolstoy-embed-start-button",embedContainer:"tolstoy-embed-container"},r=9/16}),s("99pD6",function(t,o){e(t.exports,"PUBLIC_CLASSES",function(){return s}),e(t.exports,"POSTER_SUFFIX",function(){return i}),e(t.exports,"STORIES_IMAGE_EXTENSION",function(){return a}),e(t.exports,"EMBED_STORY_MOTION",function(){return l}),e(t.exports,"STORIES_ITEMS_SIZE_TYPES",function(){return d}),e(t.exports,"STORIES_NAME_LOCATION",function(){return c}),e(t.exports,"DEFAULT_STORIES_ITEMS_SIZE_TYPE",function(){return u}),e(t.exports,"DEFAULT_STORIES_ITEMS_PER_ROW",function(){return p}),e(t.exports,"DEFAULT_STORIES_SIZE",function(){return E}),e(t.exports,"DEFAULT_STORIES_SPACING",function(){return h}),e(t.exports,"STORIES_ITEM_MAX_FIXED_SIZE",function(){return g});var n=r("iG8TK");let s={story:"tolstoy-stories",storiesMainContainer:"tolstoy-stories-main-container",storiesContainer:"tolstoy-stories-container",tilesContainer:"tolstoy-stories-tiles-container",tileName:"tolstoy-stories-tile-name",storyTile:"tolstoy-stories-tile",storyImage:"tolstoy-stories-story-image",storyVideo:"tolstoy-stories-story-video",plusTile:"tolstoy-stories-plus-tile",storyName:"tolstoy-stories-story-name",titleContainer:"tolstoy-stories-title",plusTileContainer:"tolstoy-stories-plus-tile-container",previousButton:"tolstoy-stories-previous-button",nextButton:"tolstoy-stories-next-button",onYouButton:"tolstoy-stories-on-you-button",onlyOnYouButton:"tolstoy-stories-only-on-you-button",playButtonContainer:"tolstoy-stories-play-button-container"},i=".0000000.jpg",a=`.avatar${i}`,l={static:n.EMBED_CAROUSEL_MOTION.static,dynamic:n.EMBED_CAROUSEL_MOTION.dynamic},d={responsive:"responsive",fixed:"fixed"},c={below:"below",overlay:"overlay"},u=d.fixed,p=8,E=80,h=8,g=256}),s("lPPKE",function(t,o){e(t.exports,"PUBLIC_CLASSES",function(){return n});let n={tile:"tolstoy-tile",tileContainer:"tolstoy-tile-container",video:"tolstoy-tile-video",nativeCaptionsTrack:"tolstoy-tile-native-captions-track",customCaptionsTrack:"tolstoy-tile-custom-captions-track",imageOverlay:"tolstoy-tile-image-overlay",image:"tolstoy-tile-image",controlsOverlay:"tolstoy-tile-controls-overlay",controlsContainer:"tolstoy-tile-controls",playButtonOverlay:"tolstoy-tile-play-button-overlay",playButtonContainer:"tolstoy-tile-play-button-container",playButtonLabelContainer:"tolstoy-tile-play-button-label-container",playButtonLabel:"tolstoy-tile-play-button-label",timebarWrapper:"tolstoy-tile-timebar-wrapper",timebarContainer:"tolstoy-tile-timebar-container",timebar:"tolstoy-tile-timebar",timeIndicator:"tolstoy-tile-time-indicator",muteButton:"tolstoy-tile-mute-button",fullScreenButton:"tolstoy-tile-full-screen-button",togglesContainer:"tolstoy-tile-toggles",captionsButton:"tolstoy-tile-captions-button"}}),s("4lhba",function(t,o){e(t.exports,"PUBLIC_CLASSES",function(){return n}),e(t.exports,"PLAY_MODE",function(){return r}),e(t.exports,"PLAY_VIDEOS",function(){return s}),e(t.exports,"VIDEO_PLAYBACK_MODE",function(){return i}),e(t.exports,"TILE_CLICK_MODE",function(){return a}),e(t.exports,"TILE_DATA_KEY",function(){return l});let n={collectionTile:"tolstoy-collection-tile",video:"tolstoy-collection-tile-video",controlsContainer:"tolstoy-collection-tile-controls-container",playButton:"tolstoy-collection-tile-play-button",muteButton:"tolstoy-collection-tile-mute-button"},r={AUTOPLAY:"autoplay",CLICK:"click"},s={CONSECUTIVELY:"consecutively",SIMULTANEOUSLY:"simultaneously"},i={LOOP:"loop",PLAY_ONCE:"playOnce"},a={PDP:"pdp",PLAY:"play"},l="data-tolstoy-collection-tile-key"}),s("fgRdL",function(t,o){e(t.exports,"PUBLIC_CLASS",function(){return n});let n="tolstoy-collection-page-tile"}),s("bvKjB",function(t,o){e(t.exports,"EVENT_NAMES",function(){return n});let n={embedView:"embedView",embedPlay:"embedPlay",embedPause:"embedPause",embedMute:"embedMute",embedUnmute:"embedUnmute",embedExpand:"embedExpand",tolstoyModalClose:"tolstoyModalClose",feedProductModalOpen:"feedProductModalOpen",feedProductModalClose:"feedProductModalClose",videoLoaded:"videoLoaded",pageView:"pageView",clickViewProduct:"clickViewProduct",openProductPageClick:"openProductPageClick",feedPlay:"feedPlay",feedPause:"feedPause",videoMuted:"videoMuted",videoUnmuted:"videoUnmuted",videoWatched:"videoWatched",openShareLink:"Open Share Link",feedNavigationArrowClick:"feedNavigationArrowClick",feedScroll:"feedScroll",sessionStart:"sessionStart",tolstoyStarted:"tolstoyStarted",abTestInitialized:"abTestInitialized",onYouClick:"onYouClick"}}),s("93NPo",function(t,o){e(t.exports,"uppercaseFirstChar",function(){return s}),e(t.exports,"getSafeParameter",function(){return i}),e(t.exports,"getRandomNumberBetweenTwoIntegers",function(){return a}),e(t.exports,"generateUUID",function(){return l}),e(t.exports,"logDevelopmentMessage",function(){return u}),e(t.exports,"logDevelopmentError",function(){return p}),e(t.exports,"getIsIOS",function(){return E}),e(t.exports,"getIsMobile",function(){return h}),e(t.exports,"debounce",function(){return g}),e(t.exports,"sleep",function(){return f}),e(t.exports,"safeRoundNumber",function(){return S}),e(t.exports,"removeHtmlTags",function(){return y}),e(t.exports,"isNullOrUndefined",function(){return T}),e(t.exports,"formatTime",function(){return m}),e(t.exports,"verifyUserConsent",function(){return I});var n=r("2Aomz");let s=e=>e?.length?`${e[0]?.toUpperCase()}${e?.slice(1)}`:"",i=e=>{if(!("URLSearchParams"in window))return null;try{return new URLSearchParams(window.location?.search).get(e)}catch(e){if(e)return null}},a=(e,t)=>Math.floor(Math.random()*(t-e+1))+e,l=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{let t=Math.floor(16*Math.random());return("x"===e?t:3&t|8).toString(16)}),d=()=>"development"===n.NODE_ENV,c=()=>d()||"true"===i("td"),u=e=>{c()&&console.log(e)},p=e=>{c()&&console.error(e)},E=()=>["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document,h=()=>E()||window.screen.width<=450||window.screen.height<=450,g=(e,t=300)=>{let o;return(...n)=>{clearTimeout(o),o=setTimeout(()=>{e(...n)},t)}},f=async(e=0)=>new Promise(t=>{setTimeout(t,e)}),S=(e,t=1)=>{let o=Number(e);return Number.isNaN(o)?0:Number.isInteger(o)?o:Number.parseFloat(o.toFixed(t))},y=e=>e.replace(/<[^>]*>?/gm,""),T=e=>null==e,m=e=>{let t=Math.floor(e/60),o=Math.floor(e%60);return`${t}:${o.toString().padStart(2,"0")}`},I=()=>window.Shopify?.customerPrivacy?.currentVisitorConsent().analytics!=="no"}),s("2Aomz",function(t,o){e(t.exports,"API_BASE_URL",function(){return n}),e(t.exports,"API_LB_BASE_URL",function(){return r}),e(t.exports,"API_LB_CDN_BASE_URL",function(){return s}),e(t.exports,"PLAYER_URL",function(){return i}),e(t.exports,"ON_YOU_URL",function(){return a}),e(t.exports,"HERO_URL",function(){return l}),e(t.exports,"WIDGET_DOMAIN",function(){return d}),e(t.exports,"VIDEO_OUTPUT",function(){return c}),e(t.exports,"CREATE_VIDEO_RESOLUTIONS",function(){return u}),e(t.exports,"SITE_ACTIVITY_EVENT_URL",function(){return p}),e(t.exports,"PAGE_VISIT_EVENT_URL",function(){return E}),e(t.exports,"NODE_ENV",function(){return h});let n="https://api.gotolstoy.com",r="https://apilb.gotolstoy.com",s="https://cf-apilb.gotolstoy.com",i="https://player.gotolstoy.com",a="https://on-you.gotolstoy.com",l="https://play.gotolstoy.com/hero",d="widget.gotolstoy.com",c="https://videos.gotolstoy.com",u="https://api.gotolstoy.com/migrations/recreate-video",p="https://analytics-v2.gotolstoy.com/site-activity",E="https://analytics-v2.gotolstoy.com/page-visit",h="production"}),s("dNsZ9",function(t,o){e(t.exports,"validateUUID",function(){return n});let n=e=>e?.match(/^[\da-f]{8}-[\da-f]{4}-[0-5][\da-f]{3}-[089ab][\da-f]{3}-[\da-f]{12}$/i)}),s("tZRsn",function(t,o){e(t.exports,"getIsActiveWidgetEvent",function(){return s}),e(t.exports,"getIsInactiveWidgetEvent",function(){return i});var n=r("8ptJJ");let s=e=>(0,n.ACTIVE_WIDGET_MESSAGES_EVENTS).includes(e),i=e=>(0,n.INACTIVE_WIDGET_MESSAGES_EVENTS).includes(e)}),s("i1NbZ",function(t,o){e(t.exports,"getParameterFromWidgetScripts",function(){return l}),e(t.exports,"getEmbedProductId",function(){return d}),e(t.exports,"getCurrentPageProductId",function(){return c}),e(t.exports,"getShouldUseCache",function(){return u}),e(t.exports,"getCacheVersion",function(){return p});var n=r("kCbDV"),s=r("2Aomz");let i=(e,t)=>new URL(e.src).searchParams.get(t),a=(e,t)=>e.getAttribute(`data-${t}`),l=e=>{for(let t of document.querySelectorAll(`script[src*="${s.WIDGET_DOMAIN}"]`)){let o=a(t,e)||i(t,e);if(o)return o}},d=e=>{let t=e?.dataset?.productId;return"{{ product.id }}"===t?null:t},c=()=>{let e=l(n.WIDGET_SCRIPT_PARAMETERS.productId);if(e)return e;let{stories:t,carousel:o,embed:r,tile:s}=n.EMBED_WIDGETS_CLASSNAMES;for(let e of document.querySelectorAll(`.${t}, .${o}, .${r}, .${s}`)){let t=d(e);if(t)return t}},u=()=>"true"===l(n.WIDGET_SCRIPT_PARAMETERS.shouldUseCache),p=()=>l(n.WIDGET_SCRIPT_PARAMETERS.cacheVersion)}),s("kK0IS",function(t,o){e(t.exports,"getAccountSettings",function(){return p}),e(t.exports,"postUserIdentification",function(){return E}),e(t.exports,"getProjectConfig",function(){return h}),e(t.exports,"getConfigByUrl",function(){return g}),e(t.exports,"getConfigByProductId",function(){return f}),e(t.exports,"getCollectionTileConfigs",function(){return S}),e(t.exports,"getBubbleSettings",function(){return y}),e(t.exports,"getCollectionPageTileConfig",function(){return T}),e(t.exports,"sendEvent",function(){return m}),e(t.exports,"createPlayerEvent",function(){return I}),e(t.exports,"createResolutions",function(){return N}),e(t.exports,"createSiteActivityEvent",function(){return w}),e(t.exports,"createPageVisitEvent",function(){return _});var n=r("lUrCX"),s=r("2Aomz"),i=r("i1NbZ"),a=r("93NPo"),l=r("izL3O"),d=r("6QfcD"),c=r("gxrY5");let u=()=>window.tolstoySettings?.shouldUseCache||window.tolstoySettings?.cacheVersion?s.API_LB_CDN_BASE_URL:s.API_LB_BASE_URL,p=async()=>{let e=(0,d.getAppKey)(),t=window.Shopify?.shop||(0,l.getShop)(),o=(0,i.getShouldUseCache)(),n=(0,i.getCacheVersion)(),r=o||n?s.API_LB_CDN_BASE_URL:s.API_LB_BASE_URL;try{let o=new URL(`${r}/actions/accounts/${e}`);return n&&o.searchParams.set("v",n),t&&o.searchParams.set("appUrl",t),(await fetch(o.toString())).json()}catch(e){window.tolstoyCaptureError?.(e,"Error loading account settings:")}},E=async e=>{try{if(!(0,a.verifyUserConsent)())return;return(await fetch(`${s.API_BASE_URL}/identify/identify`,{method:"POST",body:JSON.stringify({data:e})})).json()}catch(e){window.tolstoyCaptureError?.(e,"Error updating identification:")}},h=async(e,t)=>{let o=(0,i.getCurrentPageProductId)(),r=u(),s=(0,i.getCacheVersion)(),a=(0,n.getFilteredSearchParams)({widgetType:t,productId:o,publishId:e,v:s});try{return(await fetch(`${r}/settings/widget/by-publish-id?${a}`)).json()}catch(e){window.tolstoyCaptureError?.(e,"Error loading config:")}},g=async e=>{let t=u(),o=(0,i.getCacheVersion)(),r=(0,n.getFilteredSearchParams)({...e,url:`${window.location.origin}${window.location.pathname}`,v:o});try{return(await fetch(`${t}/settings/widget/by-product-url?${r}`)).json()}catch(e){window.tolstoyCaptureError?.(e,"Error getting product page config:")}},f=async e=>{let t=u(),o=(0,i.getCacheVersion)(),r=(0,n.getFilteredSearchParams)({...e,v:o});try{return(await fetch(`${t}/settings/widget/by-product-id?${r}`)).json()}catch(e){window.tolstoyCaptureError?.(e,"Error getting product page config:")}},S=async(e,t)=>{let o=u(),r=(0,i.getCacheVersion)(),s=(0,n.getFilteredSearchParams)({appKey:e,collectionId:t,v:r});try{return(await fetch(`${o}/settings/widget/get-collection-tile-config?${s}`)).json()}catch(e){window.tolstoyCaptureError?.(e,"Error getting collection tile config:")}},y=async e=>{let t=new URLSearchParams(e);try{return(await fetch(`${s.API_LB_BASE_URL}/settings/bubble?${t.toString()}`)).json()}catch(e){window.tolstoyCaptureError?.(e,"Error getting bubble settings:")}},T=async(e,t)=>{let o=u(),r=(0,i.getCacheVersion)(),s=(0,n.getFilteredSearchParams)({publishId:e,collectionId:t,v:r});try{return(await fetch(`${o}/settings/collection-page-tile-config?${s}`)).json()}catch(e){window.tolstoyCaptureError?.(e,"Error getting collection page tile config:")}},m=async e=>{if(void 0!==window.location.origin&&(0,a.verifyUserConsent)())try{return await fetch(`${s.API_BASE_URL}/events/event`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)})}catch(e){window.tolstoyCaptureError?.(e,"Error sending page view:")}},I=(0,c.sendWithInitialDelay)(m),N=async e=>{try{return await fetch(`${s.CREATE_VIDEO_RESOLUTIONS}?publishId=${e}`)}catch(e){window.tolstoyCaptureError?.(e)}},w=(0,c.sendWithInitialDelay)(e=>{if((0,a.verifyUserConsent)())try{window.navigator.sendBeacon(s.SITE_ACTIVITY_EVENT_URL,JSON.stringify(e))}catch(t){let e="Error occurred in createSiteActivityEvent";console.error(e,t),window.tolstoyCaptureError?.(t,e)}}),_=(0,c.sendWithInitialDelay)(e=>{if((0,a.verifyUserConsent)())try{window.navigator.sendBeacon(s.PAGE_VISIT_EVENT_URL,JSON.stringify(e))}catch(t){let e="Error occurred in createPageVisitEvent";console.error(e,t),window.tolstoyCaptureError?.(t,e)}})}),s("lUrCX",function(t,o){e(t.exports,"getIsTheSameURL",function(){return i}),e(t.exports,"getUrlCustomParams",function(){return a}),e(t.exports,"getFilteredSearchParams",function(){return l}),e(t.exports,"isUrl",function(){return d}),e(t.exports,"getIsEmailCampaignProject",function(){return c});let n=RegExp("^((([A-Za-z]{3,9}:(?:\\/\\/)?)(?:[\\-;:&=\\+\\$,\\w]+@)?[A-Za-z0-9\\.\\-]+|(?:www\\.|[\\-;:&=\\+\\$,\\w]+@)[A-Za-z0-9\\.\\-]+)((?:\\/[\\+~%\\/\\.\\w\\-_]*)?\\??(?:[\\-\\+=&;%@\\.\\w_]*)#?(?:[\\.\\!\\/\\\\\\w]*))?)","i"),r=e=>!!e&&(!!n.test(e)||e.startsWith("tel:")||e.startsWith("mailto:")||e.startsWith("_self:")),s=e=>{let t=new URL(e.replace("www.",""));return`${t.origin}${t.pathname}${t.search}`},i=(e,t)=>!!(r(e)&&r(t))&&s(e)===s(t),a=()=>{let e=new URLSearchParams(window.location.search),t=new URLSearchParams;for(let[o,n]of e){let e=o.toLowerCase();o.length<50&&n.length<100&&(e.startsWith("custom_")||e.startsWith("utm_"))&&t.append(o,n)}return t},l=(e={})=>{let t=new URLSearchParams;for(let[o,n]of Object.entries(e))null!=n&&""!==n&&t.append(o,n);return t.toString()},d=e=>n.test(e),c=e=>new URLSearchParams(window.location.search).get("tolstoy")===e}),s("izL3O",function(t,o){e(t.exports,"getShop",function(){return i});var n=r("kCbDV"),s=r("i1NbZ");function i(){return(0,s.getParameterFromWidgetScripts)(n.WIDGET_SCRIPT_PARAMETERS.shop)}}),s("6QfcD",function(t,o){e(t.exports,"getAppKey",function(){return a});var n=r("kCbDV"),s=r("i1NbZ");let i="";function a(){return window.tolstoyAppKey||i?window.tolstoyAppKey||i:i=(0,s.getParameterFromWidgetScripts)(n.WIDGET_SCRIPT_PARAMETERS.appKey)}}),s("gxrY5",function(t,o){e(t.exports,"sendWithInitialDelay",function(){return i});let n=!1,r=[],s=()=>{for(;r.length>0;){let{eventFunction:e,args:t}=r.shift();e(...t)}};setTimeout(()=>{n=!0,s()},4e3);let i=e=>(...t)=>{if(n)return e(...t);r.push({eventFunction:e,args:t})}}),s("eSOI5",function(t,o){e(t.exports,"getAndSetAnonymousId",function(){return w}),e(t.exports,"setPublishId",function(){return _}),e(t.exports,"getTolstoysActivity",function(){return A}),e(t.exports,"pushTolstoyActivity",function(){return b}),e(t.exports,"pushTolstoyViewedProducts",function(){return v}),e(t.exports,"clearTolstoyActivity",function(){return C}),e(t.exports,"setIsReply",function(){return L}),e(t.exports,"setTolstoyProductRecommendation",function(){return R}),e(t.exports,"getTolstoyViewers",function(){return O}),e(t.exports,"setTolstoyViewers",function(){return x}),e(t.exports,"getTolstoyInteractionDate",function(){return D}),e(t.exports,"setIdentifyInfoId",function(){return U}),e(t.exports,"getIdentifyInfoId",function(){return V}),e(t.exports,"removeIdentifyInfoId",function(){return k}),e(t.exports,"setSessionCounter",function(){return B}),e(t.exports,"getSessionCounter",function(){return H}),e(t.exports,"setFirstSeenAt",function(){return F}),e(t.exports,"getFirstSeenAt",function(){return $}),e(t.exports,"setTolstoyInteractionDate",function(){return Y}),e(t.exports,"getTolstoyHideWidget",function(){return W}),e(t.exports,"setTolstoyHideWidget",function(){return G}),e(t.exports,"removeTolstoyHideWidget",function(){return j}),e(t.exports,"getSessionId",function(){return K}),e(t.exports,"setSessionId",function(){return z}),e(t.exports,"removeSessionId",function(){return q}),e(t.exports,"getSessionUniqueId",function(){return X}),e(t.exports,"getNotVisibleOpenedTolstoyPublishId",function(){return Q}),e(t.exports,"setNotVisibileOpenedTolstoyPublishId",function(){return J}),e(t.exports,"updateTolstoyActivitySessionIdByPublishId",function(){return ee}),e(t.exports,"getIsShopifyCartAnonymousIdSet",function(){return et}),e(t.exports,"setIsShopifyCartAnonymousIdSet",function(){return eo}),e(t.exports,"setTolstoyRecreateResolution",function(){return en}),e(t.exports,"getTolstoyRecreateResolution",function(){return er}),e(t.exports,"setShowNotificationBadge",function(){return es}),e(t.exports,"getShowNotificationBadge",function(){return ei}),e(t.exports,"setShowBubbleText",function(){return ea}),e(t.exports,"getShowBubbleText",function(){return el}),e(t.exports,"setRecreateNewResolution",function(){return ed}),e(t.exports,"getRecreateNewResolution",function(){return ec}),e(t.exports,"setAbTestGroup",function(){return eu}),e(t.exports,"getAbTestGroup",function(){return ep});var n=r("lY4N9"),s=r("hlJEM"),i=r("lxjfR"),a=r("fvcet");let{TOLSTOY_HIDE_WIDGET_STORAGE_KEY:l,TOLSTOY_SESSION_ID_KEY:d,TOLSTOY_SESSION_UNIQUE_ID_KEY:c,TOLSTOY_PRODUCT_RECOMMENDATIONS:u,TOLSTOY_ANONYMOUS_ID:p,TOLSTOY_REPLY:E,TOLSTOY_GROUP:h,TOLSTOY_PUBLISH_ID:g,TOLSTOY_ACTIVITY_KEY:f,TOLSTOY_NOT_VISIBLE_OPENED_PUBLISH_ID_KEY:S,TOLSTOY_INTERACTION_DATE:y,IS_SHOPIFY_CART_ANONYMOUS_ID_SET_KEY:T,TOLSTOY_RECREATE_RESOLUTIONS_PREFIX:m,TOLSTOY_AB_TEST_GROUP:I}=s.TOLSTOY_CACHE_KEYS;function N(e){return e?`${y}-${e}`:y}function w(){var e;let t=((0,n.getIsTapcart)()?(0,n.getTapcartDeviceId)():null)||(0,i.getFromCache)(p)||(0,i.uuidv4)();return"false"===t&&(t=(0,i.uuidv4)()),!(e=t)||["undefined","false"].includes(e)||(0,i.setToCache)(p,e),t}function _(e){(0,i.setToCache)(g,e,!0)}function A(){return JSON.parse((0,i.getFromSessionStorage)(f)||"{}")}function b({publishId:e,timeStamp:t,type:o,sessionId:n}){let r=A()||{},s=r[e]||[];r[e]=[...s,{timeStamp:t,type:o,sessionId:n}],(0,i.setToSessionStorage)(f,JSON.stringify(r),!0)}let v=({publishId:e,productId:t})=>{let o=P(),n=o[t]||[],r={interactionDate:new Date().toISOString(),publishId:e,productId:t};n.push(r),o[t]=n,M(o)},C=()=>{(0,i.setToSessionStorage)(f,"{}",!0)};function L(e){(0,i.setToCache)(E,e)}function R(){(0,i.setToCache)(u,!0)}let O=()=>JSON.parse((0,i.getFromLocalStorage)(a.Keys.TOLSTOY_VIEWERS_KEY)||"{}"),P=()=>JSON.parse((0,i.getFromCache)(a.Keys.TOLSTOY_VIEWED_PRODUCTS)||"{}"),M=e=>{(0,i.setToCache)(a.Keys.TOLSTOY_VIEWED_PRODUCTS,JSON.stringify(e))},x=e=>{(0,i.setLocalStorage)(a.Keys.TOLSTOY_VIEWERS_KEY,JSON.stringify(e))};function D(e){return(0,i.getFromCache)(N(e))||(0,i.getFromCache)(N())}function U(e){(0,i.setLocalStorage)(a.Keys.IDENTIFY_INFO_ID_KEY,e)}function V(){return(0,i.getFromLocalStorage)(a.Keys.IDENTIFY_INFO_ID_KEY)}function k(){localStorage.removeItem(a.Keys.IDENTIFY_INFO_ID_KEY)}let B=e=>{(0,i.setLocalStorage)(a.Keys.SESSION_COUNTER_KEY,e)},H=()=>Number((0,i.getFromLocalStorage)(a.Keys.SESSION_COUNTER_KEY)),F=e=>{(0,i.setLocalStorage)(a.Keys.FIRST_SEEN_AT_KEY,e)},$=()=>(0,i.getFromLocalStorage)(a.Keys.FIRST_SEEN_AT_KEY);function Y(e){let t=new Date().toISOString();(0,i.setToCache)(N(e),t)}let W=e=>(0,i.getFromSessionStorage)(`${l}-${e}`),G=e=>(0,i.setToSessionStorage)(`${l}-${e}`,"true",!0),j=e=>window.sessionStorage.removeItem(`${l}-${e}`),K=()=>(0,i.getFromSessionStorage)(d),z=e=>(0,i.setToSessionStorage)(d,e,!0),q=()=>(0,i.removeFromSessionStorage)(d),X=()=>(0,i.getFromSessionStorage)(c)||Z(),Z=()=>{let e=(0,i.uuidv4)();return(0,i.setToSessionStorage)(c,e,!0),e},Q=()=>{let e=(0,i.getFromSessionStorage)(S);return e&&"null"!==e?e:null},J=e=>(0,i.setToSessionStorage)(S,e,!0),ee=(e,t)=>{let o=A()||{},n=o[e]||[];n?.length&&(n[n.length-1].sessionId=t,(0,i.setToSessionStorage)(f,JSON.stringify(o),!0))},et=()=>(0,i.getFromSessionStorage)(T),eo=e=>(0,i.setToSessionStorage)(T,e),en=e=>(0,i.setLocalStorage)(`${m}-${e}`,"true",!0),er=e=>(0,i.getFromLocalStorage)(`${m}-${e}`),es=(e,t)=>(0,i.setLocalStorage)(`${a.Keys.NOTIFICATION_BADGE_PREFIX}-${e}`,t,!0),ei=e=>(0,i.getFromLocalStorage)(`${a.Keys.NOTIFICATION_BADGE_PREFIX}-${e}`),ea=(e,t,o)=>(0,i.setLocalStorage)(`${a.Keys.BUBBLE_TEXT_PREFIX}-${e}-${t}`,o,!0),el=(e,t)=>(0,i.getFromLocalStorage)(`${a.Keys.BUBBLE_TEXT_PREFIX}-${e}-${t}`),ed=(e,t)=>(0,i.setLocalStorage)(`${a.Keys.RECREATE_NEW_RESOLUTION_PREFIX}-${e}`,t,!0),ec=e=>(0,i.getFromLocalStorage)(`${a.Keys.RECREATE_NEW_RESOLUTION_PREFIX}-${e}`),eu=(e,t)=>(0,i.setLocalStorage)(`${I}-${e}`,t,!0),ep=e=>(0,i.getFromLocalStorage)(`${I}-${e}`)}),s("lY4N9",function(t,o){e(t.exports,"getIsTapcart",function(){return n}),e(t.exports,"getTapcartDeviceId",function(){return r});let n=()=>!!(window?.Tapcart?.isInitialized||document.location?.host?.includes("custom-blocks.tapcart.com")),r=()=>{let e=window?.Tapcart?.variables?.device?.id;return e?.toLowerCase()}}),s("hlJEM",function(t,o){e(t.exports,"TOLSTOY_CACHE_KEYS",function(){return n}),e(t.exports,"COOKIE_POLICIES",function(){return r});let n={TOLSTOY_HIDE_WIDGET_STORAGE_KEY:"tolstoy-hide-widget",TOLSTOY_SESSION_ID_KEY:"tolstoy-session-id",TOLSTOY_SESSION_UNIQUE_ID_KEY:"tolstoy-session-unique-id",TOLSTOY_PRODUCT_RECOMMENDATIONS:"tolstoy-product-recommendation",TOLSTOY_ANONYMOUS_ID:"tolstoy-anonymousId",TOLSTOY_REPLY:"tolstoy-reply",TOLSTOY_GROUP:"tolstoy-group",TOLSTOY_PUBLISH_ID:"tolstoy-publishId",TOLSTOY_ACTIVITY_KEY:"tolstoy-activity",TOLSTOY_NOT_VISIBLE_OPENED_PUBLISH_ID_KEY:"tolstoy-not-visible-opened-publish-id",TOLSTOY_INTERACTION_DATE:"tolstoy-interaction-date",IS_SHOPIFY_CART_ANONYMOUS_ID_SET_KEY:"tolstoy-is-shopify-cart-anonymous-id-set",TOLSTOY_COOKIE_POLICY:"tolstoy-cookie-policy",TOLSTOY_RECREATE_RESOLUTIONS_PREFIX:"tolstoy-recreate-resolutions",TOLSTOY_AB_TEST_GROUP:"tolstoy-ab-test-group"},r={accepted:"accepted",rejected:"rejected"}}),s("lxjfR",function(t,o){e(t.exports,"uuidv4",function(){return a}),e(t.exports,"getFromSessionStorage",function(){return d}),e(t.exports,"getFromLocalStorage",function(){return c}),e(t.exports,"getFromCache",function(){return u}),e(t.exports,"setToSessionStorage",function(){return p}),e(t.exports,"setLocalStorage",function(){return E}),e(t.exports,"setToCache",function(){return h}),e(t.exports,"removeFromSessionStorage",function(){return g}),e(t.exports,"setCookiePolicy",function(){return S}),e(t.exports,"removeAllTolstoyKeysFromStorage",function(){return m});var n=r("hlJEM"),s=r("fvcet");let{TOLSTOY_COOKIE_POLICY:i}=n.TOLSTOY_CACHE_KEYS;function a(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let t=Math.trunc(16*Math.random());return("x"===e?t:3&t|8).toString(16)})}function l(e){try{return e()}catch(e){return window.tolstoyCaptureError?.(e),null}}function d(e){return l(()=>window.sessionStorage.getItem(e))}function c(e){return l(()=>localStorage.getItem(e))||d(e)}function u(e){return c(e)||d(e)}function p(e,t,o=!1){l(()=>{if(f()!==n.COOKIE_POLICIES.rejected||o)return window.sessionStorage.setItem(e,t)})}function E(e,t,o=!1){l(()=>f()!==n.COOKIE_POLICIES.rejected?localStorage.setItem(e,t):o?window.sessionStorage.setItem(e,t):void 0)}function h(e,t,o=!1){l(()=>f()!==n.COOKIE_POLICIES.rejected?localStorage.setItem(e,t):o?window.sessionStorage.setItem(e,t):void 0)}function g(e){return l(()=>window.sessionStorage.removeItem(e))}let f=()=>u(i),S=e=>{h(i,e,!0)},y=e=>{let t=window.location.host;document.cookie=`${e}=; path=/; domain=.${t}; expires=Thu, 01 Jan 1970 00:00:00 UTC;`,document.cookie=`${e}=; path=/; expires=Thu, 01 Jan 1970 00:00:00 UTC;`},T=e=>[...Object.values(n.TOLSTOY_CACHE_KEYS),...Object.values(s.Keys)].some(t=>e.includes(t));function m(){for(let e of document.cookie.split("; ")){let[t]=e.split("=");T(t.trim())&&y(t)}for(let e in localStorage)T(e)&&localStorage.removeItem(e);for(let e in sessionStorage)T(e)&&sessionStorage.removeItem(e)}(()=>{for(let e of document.cookie.split("; ")){let[t]=e.split("=");T(t.trim())&&y(t)}})()}),s("fvcet",function(t,o){e(t.exports,"Keys",function(){return n});let n={IDENTIFY_INFO_ID_KEY:"identifyInfoId",SESSION_COUNTER_KEY:"tolstoySessionCounter",LAST_SEEN_AT_KEY:"tolstoyLastSeenAtKey",FIRST_SEEN_AT_KEY:"tolstoyFirstSeenAtKey",TOLSTOY_VIEWERS_KEY:"tolstoyViewers",TOLSTOY_VIEWED_PRODUCTS:"tolstoyViewedProducts",CURRENT_CUSTOMER_EMAIL_KEY:"tolstoyCurrentCustomer",BUBBLE_TEXT_PREFIX:"bubbleText",NOTIFICATION_BADGE_PREFIX:"notificationBadge",RECREATE_NEW_RESOLUTION_PREFIX:"reCreateNewResolution"}}),s("xb7kn",function(t,o){e(t.exports,"tolstoyWidgetReady",function(){return s}),e(t.exports,"tolstoyPlayerReady",function(){return i});var n=r("8ptJJ");let s=()=>{let e=new CustomEvent("tolstoyWidgetReady");window.dispatchEvent(e)},i=()=>{let e=new CustomEvent(n.TOLSTOY_PLAYER_READY_MESSAGE);window.dispatchEvent(e)}}),s("ljwIw",function(t,o){e(t.exports,"createElement",function(){return n}),e(t.exports,"createScript",function(){return r}),e(t.exports,"createIframe",function(){return s}),e(t.exports,"registerDomUpdatesListener",function(){return l}),e(t.exports,"safePlayVideo",function(){return d}),e(t.exports,"stringToHTML",function(){return c}),e(t.exports,"getPublicId",function(){return u}),e(t.exports,"getElementSelector",function(){return p}),e(t.exports,"getElement",function(){return E}),e(t.exports,"getCustomElementSelector",function(){return h}),e(t.exports,"getCustomElement",function(){return g});let n=({tagName:e,src:t,container:o,attributes:n,style:r,styleString:s,classNames:i,eventListeners:a})=>{let l=document.createElement(e);if(a)for(let[e,t]of Object.entries(a))l.addEventListener(e,t);if(t&&(l.src=t),n)for(let[e,t]of Object.entries(n))l.setAttribute(e,t);if(s&&(l.style.cssText=s),r)for(let[e,t]of Object.entries(r))l.style[e]=t;return i&&l.classList.add(...i),o&&o.append(l),l},r=({src:e,container:t,attributes:o})=>n({tagName:"script",src:e,container:t,attributes:o}),s=({src:e,container:t,attributes:o,style:r})=>n({tagName:"iframe",src:e,container:t,attributes:o,style:r}),i=({callback:e,classNames:t})=>{let o=e=>t.some(t=>e.getElementsByClassName(t).length>0),n=e=>t.includes(e),r=e=>[...e.classList].some(n),s=e=>!!e.classList&&(r(e)||o(e)),i=e=>"childList"===e.type&&0!==e.addedNodes.length&&[...e.addedNodes].some(s);new window.MutationObserver(t=>{t.some(i)&&e()}).observe(document.body,{subtree:!0,childList:!0})},a=({callback:e})=>{window.addEventListener("DOMContentLoaded",e),window.addEventListener("load",e)},l=({callback:e,classNames:t})=>{a({callback:e}),"MutationObserver"in window&&i({callback:e,classNames:t})},d=({video:e,onError:t})=>e?.play().catch(t),c=e=>{let t=document.createElement("div");return t.innerHTML=e.trim(),t.firstChild},u=(e,t)=>`${e}-${t}`,p=(e,t)=>`[data-tolstoy-element="${u(e,t)}"]`,E=(e,t)=>window.document.querySelector(p(e,t)),h=(e,t)=>`[${e}="${t}"]`,g=(e,t)=>window.document.querySelector(`[${e}="${t}"]`)}),s("2S3LN",function(t,o){e(t.exports,"getPublicId",function(){return S}),e(t.exports,"getEmbedPublishId",function(){return y}),e(t.exports,"getEmbedCollectionId",function(){return T}),e(t.exports,"reloadFontIfNeeded",function(){return m}),e(t.exports,"getVideoBaseUrl",function(){return I}),e(t.exports,"getAllElements",function(){return w}),e(t.exports,"stopAllVideos",function(){return _}),e(t.exports,"stopDynamicVideos",function(){return A}),e(t.exports,"onViewPortChangeHandler",function(){return b}),e(t.exports,"getConfig",function(){return v}),e(t.exports,"shouldForceMute",function(){return C}),e(t.exports,"getMessageFromError",function(){return L}),e(t.exports,"getIsElementVisible",function(){return R}),e(t.exports,"getPageVariantId",function(){return O});var n=r("ljwIw"),s=r("68VIL"),i=r("519R9"),a=r("aEodP"),l=r("dQiGr"),d=r("6QfcD"),c=r("jvykV"),u=r("kK0IS"),p=r("kCbDV"),E=r("1A9Dw"),h=r("8ZCcc"),g=r("6MJM3"),f=r("iG8TK");let S=(e,t,o)=>o?`${e}-${t}-${o}`:`${e}-${t}`,y=e=>e.dataset.publishId?e.dataset.publishId:e.id?e.id.split("_")[0]:"",T=e=>e?.dataset?.collectionId,m=e=>{let t=e?.design?.branding?.typography?.font,o=e?.design?.branding?.typography?.fontHeading;(t?.family||o?.family)&&(t?.family&&(0,c.reloadFont)(t),o?.family&&(0,c.reloadFont)(o,"tolstoy-custom-heading-font-family"))},I=({step:e,embedMotion:t,isStory:o,loadAll:n=!1,isCarouselPlayInTileFirst:r})=>{if(t===f.EMBED_CAROUSEL_MOTION.static||r)return null;let s=window.innerWidth<=450,i=t===f.EMBED_CAROUSEL_MOTION.hoverOver,a=t===f.EMBED_CAROUSEL_MOTION.dynamic;return a&&n?(0,g.getBaseUrl)({step:e,isStory:o}):i&&s||a?null:(0,g.getBaseUrl)({step:e,isStory:o})},N=e=>{let t=e.getBoundingClientRect();return t.top>=-t.height&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)},w=(e,t)=>window.document.querySelectorAll(`[data-tolstoy-element="${S(e,t)}"]`),_=({videoClass:e,publishId:t,removeEventListenerFunction:o})=>{for(let n of w(e,t))n.pause(),o?.(n)},A=({videoClass:e,publishId:t,setIsDynamicVideoRunning:o,onVideoEnd:n})=>{o(!1),_({videoClass:e,publishId:t,removeEventListenerFunction:e=>{e.removeEventListener("ended",n)}})},b=({videoClass:e,isDynamicVideoRunning:t,setIsDynamicVideoRunning:o,dynamicVideoHandler:n,publishId:r,onVideoEnd:s})=>{let i=w(e,r);if(0===i.length)return;let a=N(i[0]);!a&&t?(A({videoClass:e,publishId:r,setIsDynamicVideoRunning:o,onVideoEnd:s}),o(!1)):a&&!t&&(n(),o(!0))},v=async({publishId:e,productId:t,widgetType:o,tags:n,appUrl:r,variantId:s})=>{let c=t&&t!==p.PLACEHOLDER_PRODUCT_ID?u.getConfigByProductId:u.getConfigByUrl,g=window.tolstoyAppKey||(0,d.getAppKey)()||"",f=new URLSearchParams(window.location.search),S=s||f.get("variant"),y=await c({productId:t,defaultPublishId:e,widgetType:o,appKey:g,tags:n,appUrl:r,variantId:S});return(new E.default(o).init(y)||{}).hideElement?{disabled:!0}:(y?.disabled||((0,h.getFeatureIsEnabled)({config:y,featureKey:l.FEATURE_BLOCK_SHOPIFY_ADD_TO_CART_ATTRIBUTE})&&(0,i.default).postMessage({eventName:a.INTERNAL_EVENTS.blockAnonymousIdToCart,appKey:g}),y?.openCommerceSettings&&(0,i.default).postMessage({eventName:a.INTERNAL_EVENTS.openCommerceSettingsUpdate,openCommerceSettings:y.openCommerceSettings})),y)};function C(e,t){return!!(null==t?e:!t)}let L=e=>{let t=e=>{let t=(0,n.stringToHTML)(e);return t.style.verticalAlign="middle",t.style.margin="0 5px",t.style.marginBottom="3px",t},o=document.createElement("p"),r=t((0,s.getWarningIcon)()),i=t((0,s.getPublishIcon)());return o.append(r),(({"Invalid publishId":["Add the publish ID from the",i,"tab of your project in Tolstoy"],"Project is not live":["Your project is in draft. Publish project in the",i," tab of your project in Tolstoy"],"Project is deleted":["Project has been deleted"],"No videos found":["Select videos in the Videos tab of your project in Tolstoy"],"No filtered videos found":["Select videos in the Videos tab of your project in Tolstoy"],"No connections found":["Select videos in the Videos tab of your project in Tolstoy"],"No videos found for product":["Add tagged videos for this product in the Videos tab of your project in Tolstoy"]})[e]||["Couldn't find product page"]).forEach(e=>{"string"==typeof e?o.append(document.createTextNode(e)):o.append(e)}),o},R=({element:e})=>{let t=e.getBoundingClientRect();return 0!==t.width&&0!==t.height&&t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)},O=()=>new URLSearchParams(window.location.search).get("variant")}),s("68VIL",function(t,o){e(t.exports,"xButtonsSvg",function(){return n}),e(t.exports,"getFeedXButtonSvg",function(){return r}),e(t.exports,"getPlayButtonSvg",function(){return s}),e(t.exports,"leftArrowSvg",function(){return i}),e(t.exports,"rightStraightArrowSvg",function(){return a}),e(t.exports,"rightChevron",function(){return l}),e(t.exports,"getPauseSvg",function(){return d}),e(t.exports,"getMutedSvg",function(){return c}),e(t.exports,"getUnmutedSvg",function(){return u}),e(t.exports,"getWarningIcon",function(){return p}),e(t.exports,"getPublishIcon",function(){return E});let n=`<svg style="margin-left: 0.5px; width: 11px !important; height: 10px !important;" width="11" height="10" viewBox="0 0 14 13" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M13.0547 12.5938C12.8203 12.8281 12.3906 12.8281 12.1562 12.5938L7 7.39844L1.80469 12.5938C1.57031 12.8281 1.14062 12.8281 0.90625 12.5938C0.671875 12.3594 0.671875 11.9297 0.90625 11.6953L6.10156 6.5L0.90625 1.34375C0.671875 1.10938 0.671875 0.679688 0.90625 0.445312C1.14062 0.210938 1.57031 0.210938 1.80469 0.445312L7 5.64062L12.1562 0.445312C12.3906 0.210938 12.8203 0.210938 13.0547 0.445312C13.2891 0.679688 13.2891 1.10938 13.0547 1.34375L7.85938 6.5L13.0547 11.6953C13.2891 11.9297 13.2891 12.3594 13.0547 12.5938Z" fill="white"/>
</svg>
`,r=(e="#FFFFFF")=>`<svg width="18" height="18" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M16.055 16.594a.662.662 0 0 1-.899 0L10 11.398l-5.195 5.196a.662.662 0 0 1-.899 0 .662.662 0 0 1 0-.899L9.102 10.5 3.906 5.344a.662.662 0 0 1 0-.899.662.662 0 0 1 .899 0L10 9.641l5.156-5.196a.662.662 0 0 1 .899 0 .662.662 0 0 1 0 .899L10.859 10.5l5.196 5.195a.662.662 0 0 1 0 .899Z" style="fill: ${e} !important;"
   /></svg>`,s=(e="#fff",t="")=>`<svg class="${t}" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"><path d="M4 3.532c0-1.554 1.696-2.514 3.029-1.715l14.113 8.468c1.294.777 1.294 2.653 0 3.43L7.029 22.183c-1.333.8-3.029-.16-3.029-1.715V3.532Z" fill="${e}"/></svg>`,i='<svg width="10" height="18" viewBox="0 0 10 18" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M7.797 16.664.648 9.204A1.071 1.071 0 0 1 .375 8.5c0-.195.078-.43.234-.625L7.758.415a.932.932 0 0 1 1.328-.04c.39.352.39.938.039 1.328L2.602 8.5l6.562 6.875a.932.932 0 0 1-.039 1.328.932.932 0 0 1-1.328-.039Z" fill="#090A0B"/></svg>',a='<svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.804 6.563 6.902 2.661l.619-.619L12.478 7l-4.983 4.983-.619-.619 3.927-3.926H1.96v-.875z" fill="#fff" stroke="#fff"/></svg>',l=`<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="20 16 10 12" fill="none">
  <path d="M22.1274 28L28.1274 22L22.1274 16" stroke="#5C5C5C" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
</svg>`,d=(e="#fff",t="")=>`
<svg class="${t}" width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
  <g clipPath="url(#pauseIcon)">
    <path
      d="M4.375 2.5c-.633 0-1.125.516-1.125 1.125v6.75A1.11 1.11 0 0 0 4.375 11.5h.75c.61 0 1.125-.492 1.125-1.125v-6.75A1.14 1.14 0 0 0 5.125 2.5h-.75Zm4.5 0c-.633 0-1.125.516-1.125 1.125v6.75A1.11 1.11 0 0 0 8.875 11.5h.75c.61 0 1.125-.492 1.125-1.125v-6.75A1.14 1.14 0 0 0 9.625 2.5h-.75Z"
      fill="#fff"
    />
  </g>
  <defs>
    <clipPath id="pauseIcon">
      <path fill="${e}" d="M3 2.5h8v9H3z" />
    </clipPath>
  </defs>
</svg>
`,c=({color:e="#fff",className:t=""}={})=>`<svg class="${t}" width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg" aria-label="Mute tolstoy video"><path d="M6.266 1.551a0.667 0.667 0 0 1 0.382 0.583v7.714c0 0.261 -0.161 0.482 -0.381 0.602a0.651 0.651 0 0 1 -0.703 -0.12L2.85 7.918h-1.346a1.269 1.269 0 0 1 -1.286 -1.286v-1.286c0 -0.703 0.562 -1.286 1.286 -1.286h1.346L5.563 1.671a0.651 0.651 0 0 1 0.703 -0.12Zm2.492 2.651 1.105 1.106 1.105 -1.106c0.18 -0.18 0.483 -0.18 0.663 0 0.201 0.201 0.201 0.502 0 0.683L10.526 5.991l1.106 1.104c0.201 0.201 0.201 0.502 0 0.683a0.44 0.44 0 0 1 -0.663 0l-1.106 -1.105 -1.104 1.106c-0.201 0.201 -0.502 0.201 -0.683 0 -0.201 -0.182 -0.201 -0.483 0 -0.684l1.105 -1.105L8.073 4.886c-0.2 -0.18 -0.2 -0.482 0 -0.683 0.182 -0.18 0.483 -0.18 0.684 0Z" fill="${e}"/></svg>`,u=({color:e="#fff",className:t=""}={})=>`<svg class="${t}" width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg" aria-label="Unmute tolstoy video"><path d="M6.627 1.55c.238.101.411.342.411.583v7.714c0 .261-.173.482-.411.603a.742.742 0 0 1-.757-.121l-2.921-2.41H1.5c-.779 0-1.385-.563-1.385-1.286V5.347c0-.703.606-1.286 1.385-1.286h1.449l2.921-2.39a.742.742 0 0 1 .757-.121Zm3.721 1.447c.931.723 1.537 1.788 1.537 2.993 0 1.225-.606 2.29-1.537 2.993a.542.542 0 0 1-.735-.06c-.195-.201-.152-.502.065-.683.714-.522 1.168-1.326 1.168-2.25 0-.904-.454-1.708-1.168-2.23a.475.475 0 0 1-.065-.683.565.565 0 0 1 .735-.08ZM9.029 4.503c.476.362.779.884.779 1.487 0 .623-.303 1.145-.779 1.507a.55.55 0 0 1-.736-.081.454.454 0 0 1 .087-.663.966.966 0 0 0 .389-.763.928.928 0 0 0-.389-.743.475.475 0 0 1-.087-.683.57.57 0 0 1 .736-.061Z" fill="${e}"/></svg>`,p=()=>`
<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#ff0000" stroke-width="2.4" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-circle-alert"><circle cx="12" cy="12" r="10"/><line x1="12" x2="12" y1="8" y2="12"/><line x1="12" x2="12.01" y1="16" y2="16"/></svg>
`,E=()=>`
<svg width="40" height="20" xmlns="http://www.w3.org/2000/svg">
    <rect width="40" height="20" rx="3" ry="3" style="fill:blue;"/>
    <text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle" font-size="8" font-weight="normal" fill="white" letter-spacing="0.1px">
        Publish
    </text>
</svg>
`}),s("519R9",function(t,o){e(t.exports,"default",function(){return l});var n=r("dEa8z"),s=r("93NPo");class i extends n.default{constructor(){if(i.instance)return i.instance;super({shouldArchivePastEvents:!0}),i.instance=this}eventHandler=e=>{let{data:t={}}=e,{eventName:o}=t;if(this.eventCallbacks[o])for(let t of this.eventCallbacks[o])t(e)};postMessage=e=>{let t=e.transmissionId||(0,s.generateUUID)();return super.postMessage({...e,transmissionId:t}),t};init=()=>{this.initListener(this.eventHandler)}}let a=new i;Object.freeze(a);var l=a}),s("dEa8z",function(t,o){e(t.exports,"default",function(){return s});var n=r("lqvQ6"),s=class{constructor({shouldIncludeLogs:e=!1,shouldArchivePastEvents:t=!1}={}){this.broadcastHub=new n.default,this.eventCallbacks={},this.pastEvents={},this.shouldIncludeLogs=e,this.shouldArchivePastEvents=t}logMessage(e){this.shouldIncludeLogs&&console.log(e)}throwError(e){if(this.shouldIncludeLogs)throw Error(e)}archivePastEvent(e){if(!this.shouldArchivePastEvents)return;let{eventName:t}=e;this.pastEvents[t]||(this.pastEvents[t]=[]),this.pastEvents[t].push(e)}postMessage(e){this.archivePastEvent(e),this.broadcastHub.postMessage(e)}postPastEvents({eventName:e,callback:t}){if(this.pastEvents[e])for(let o of this.pastEvents[e])t({data:{...o,isPastEvent:!0}})}subscribe({eventName:e,callback:t,shouldIncludePastEvents:o}){if(this.eventCallbacks[e]||(this.eventCallbacks[e]=new Set),this.eventCallbacks[e].has(t)){this.throwError(`Already subscribed to event ${e} with this callback`);return}this.eventCallbacks[e].add(t),o&&this.postPastEvents({eventName:e,callback:t})}subscribeMultipleEvents=({eventNames:e,callback:t,shouldIncludePastEvents:o})=>{for(let n of e)this.subscribe({eventName:n,callback:t,shouldIncludePastEvents:o})};unsubscribe({eventName:e,callback:t}){if(!this.eventCallbacks[e]){this.throwError(`Not subscribed to event ${e}`);return}if(!this.eventCallbacks[e].has(t)){this.throwError("Callback is not subscribed");return}if(!this.eventCallbacks[e].delete(t)){this.logMessage(`Not subscribed to event ${e} with this callback`);return}this.logMessage(`Unsubscribed from event ${e}`)}unsubscribeMultipleEvents=({eventNames:e,callback:t})=>{for(let o of e)this.unsubscribe({eventName:o,callback:t})};initListener(e){this.broadcastHub.addEventListener("message",e)}}}),s("lqvQ6",function(t,o){e(t.exports,"default",function(){return s});var n=r("93NPo"),s=class{constructor(e){this.name=e||(0,n.generateUUID)();try{"BroadcastChannel"in self&&(this.broadcaster=new BroadcastChannel(this.name),this.receiver=new BroadcastChannel(this.name))}catch(e){console.error("self is not defined",e)}}postMessage=e=>{this.broadcaster?.postMessage(e)};addEventListener=(...e)=>{this.receiver?.addEventListener(...e)}}}),s("aEodP",function(t,o){e(t.exports,"INTERNAL_EVENTS",function(){return n});let n={modalOpen:"tolstoyModalOpen",playerReady:"tolstoyPlayerReady",toggleFeedCloseButton:"toggleFeedCloseButton",showFeedProductModal:"showFeedProductModal",reportModalOpen:"tolstoyReportModalOpen",reportModalClose:"tolstoyReportModalClose",modalMessagingReady:"tolstoyModalMessagingReady",closePlayer:"tolstoyClosePlayer",userEmailUpdate:"tolstoyUserEmailUpdate",isRebuyAppInstalled:"tolstoyIsRebuyAppInstalled",openRebuyCart:"tolstoyOpenRebuyCart",rebuyCartShown:"rebuyCartShown",rebuyCartHidden:"rebuyCartHidden",openKendoModal:"tolstoyOpenKendoModal",changeZIndex:"tolstoyChangeZIndex",isAfterpayAppInstalled:"tolstoyIsAfterpayAppInstalled",getProductsMetafields:"getProductsMetafields",returnProductsMetafields:"returnProductsMetafields",productCardClick:"tolstoyProductCardClick",spotlightCarouselQuickShopClick:"tolstoySpotlightCarouselQuickShopClick",externalEventSubscribed:"tolstoyExternalEventSubscribed",productCardClickSubscribed:"tolstoyProductCardClickSubscribed",isTapcart:"tolstoyIsTapcart",openTapcartProduct:"tolstoyOpenTapcartProduct",setAnonymousIdToCart:"tolstoySetAnonymousIdToCart",blockAnonymousIdToCart:"tolstoyBlockAnonymousIdToCart",addToCart:"tolstoyAddToCart",addToCartSuccess:"tolstoyAddToCartSuccess",addToCartError:"tolstoyAddToCartError",addToCartSoldOut:"tolstoyAddToCartSoldOut",addToCartDisableDefault:"tolstoyAddToCartDisableDefault",cartItemQuantityChange:"tolstoyCartItemQuantityChange",cartItemQuantityChangeSuccess:"tolstoyCartItemQuantityChangeSuccess",cartItemQuantityChangeError:"tolstoyCartItemQuantityChangeError",cartDataRequest:"tolstoyCartDataRequest",cartDataResponse:"tolstoyCartDataResponse",loginWithMultipassUrlRequest:"tolstoyLoginWithMultipassUrl",loginWithMultipassUrlResponse:"tolstoyLoginWithMultipassUrlResponseMessage",productRecommendationsRequest:"tolstoyProductRecommendationsRequest",productRecommendationsResponse:"tolstoyProductRecommendationsResponse",requestProductsUpdate:"tolstoyRequestProductsUpdate",productUpdateResponse:"tolstoyProductUpdateResponse",moveToUrl:"tolstoyMoveToUrl",isNonBaseCurrency:"tolstoyIsNonBaseCurrency",urlChange:"urlChange",urlLocaleUpdate:"tolstoyUrlLocaleUpdate",openCommerceSettingsUpdate:"tolstoyOpenCommerceSettingsUpdate",rejectCookiePolicy:"rejectCookiePolicy"}}),s("dQiGr",function(t,o){e(t.exports,"FEATURE_WIDGET_LOADING",function(){return n}),e(t.exports,"FEATURE_WIDGET_ONYOU",function(){return r}),e(t.exports,"FEATURE_WIDGET_ONYOU_ALL_PAGES",function(){return s}),e(t.exports,"FEATURE_WIDGET_FALLBACK_VIDEO",function(){return i}),e(t.exports,"FEATURE_CAROUSEL_SHOW_DOTS",function(){return a}),e(t.exports,"FEATURE_CAROUSEL_VIDEOS",function(){return l}),e(t.exports,"FEATURE_HIDE_SPOTLIGHT_PLUS_BUTTON",function(){return d}),e(t.exports,"FEATURE_APP_USE_CREATOR_PROFILE",function(){return c}),e(t.exports,"FEATURE_BLOCK_SHOPIFY_ADD_TO_CART_ATTRIBUTE",function(){return u}),e(t.exports,"FEATURE_SHOPIFY_PRICE_FORMATTING",function(){return p});let n="widget-loading",r="widget-onyou",s="widget-onyou-enableAllPages",i="widget-video-fallback",a="carousel-show-dots",l="carousel-videos",d="hide-spotlight-plus-button",c="app-use-creator-profile",u="block-shopify-add-to-cart-attribute",p="shopify-price-formatting"}),s("jvykV",function(t,o){e(t.exports,"reloadFont",function(){return l});var n=r("e857j");let s=[],i=(e,t=1)=>{if(e&&3!==t){if(!document.querySelector("#tolstoyWidgetElement")){setTimeout(()=>{i(e,t+1)},1e3);return}document.querySelector("#tolstoyWidgetElement").style.fontFamily=`${e}, ${n.FALLBACK_FONTS}`}},a=e=>Array.from(document.head.querySelectorAll("style")).some(t=>t.textContent.includes(`@font-face { font-family: '${e}';`));function l(e,t="tolstoy-custom-font-family"){if(!e||s.includes(t)||a(t))return;let{sources:o}=e;(function(e,t){let o="italic",n="normal",r={".ttf":"truetype",".otf":"opentype",".woff":"woff",".woff2":"woff2"},s=document.createElement("style");for(let i of Object.keys(e)){let a=e[i],l=i.includes(o),d=i.split("-")[1]||i.replace(o,"")||n,c=l?o:n,u=Object.keys(r).find(e=>a.includes(e)),p=r[u],E=a.replace("http://","https://");s.append(document.createTextNode(`@font-face { font-family: '${t}'; src: url("${E}") format("${[p]}"); font-weight: ${d}; font-style: ${c}; font-display: swap;}`))}document.head.append(s)})(o,t),i(t),s.push(t)}}),s("e857j",function(t,o){e(t.exports,"FALLBACK_FONTS",function(){return n}),e(t.exports,"TOLSTOY_CUSTOM_FONT_FAMILY",function(){return r}),e(t.exports,"TOLSTOY_CUSTOM_HEADING_FONT_FAMILY",function(){return s});let n="Nunito Sans, sans-serif",r="tolstoy-custom-font-family",s="tolstoy-custom-heading-font-family"}),s("1A9Dw",function(t,o){e(t.exports,"default",function(){return l});var n=r("9bB3T"),s=r("bvKjB"),i=r("eSOI5");let a={A:"A",B:"B"};var l=class{constructor(e){this.widgetType=e}sendAbTestInitializedEvent({abTestId:e,group:t,excludeExternalAnalytics:o,probability:n}){let r={abTestId:e,eventName:s.EVENT_NAMES.abTestInitialized,sessionUniqueId:(0,i.getSessionUniqueId)(),testGroup:t,probability:n};this.analytics.sendEventImmediately(r,o)}initializeGroup({abTestId:e,probability:t,excludeExternalAnalytics:o}){let n=(0,i.getAbTestGroup)(e);if(n){this.group=n;return}let r=Math.random()>t?a.B:a.A;this.group=r,this.sendAbTestInitializedEvent({abTestId:e,group:r,excludeExternalAnalytics:o,probability:t}),(0,i.setAbTestGroup)(e,r)}init(e){if(!e)return;let{abTestSettings:t={}}=e,{isEnabled:o,abTestId:r,probability:s,groupASettings:i={},groupBSettings:l={},excludeExternalAnalytics:d}=t;if(o)return this.analytics=new n.default({config:e,playerType:this.widgetType}),this.initializeGroup({abTestId:r,probability:s,excludeExternalAnalytics:d}),this.group===a.A?i:l}}}),s("9bB3T",function(t,o){e(t.exports,"default",function(){return E});var n=r("bvKjB"),s=r("aQK74"),i=r("igWUq"),a=r("50h3S"),l=r("i1NbZ"),d=r("eSOI5"),c=r("kK0IS"),u=r("lxjfR"),p=r("93NPo"),E=class{constructor({config:e,playerType:t,collectionId:o}){this.config=e,this.publishId=e.publishId,this.playerType=t,this.sessionId=(0,d.getSessionId)()||(0,u.uuidv4)(),this.anonymousId=(0,d.getAndSetAnonymousId)(),this.currentPageProductId=(0,l.getCurrentPageProductId)(),this.collectionId=o,this.errors={}}getIsMobile(){return window.screen.width<=450||window.screen.height<=450}getAnalyticsParams(e={}){let{id:t,appKey:o,name:n,googleAnalyticsID:r}=this.config,s=window.location.href.split("?")[0],i=window.Shopify?.shop,a=this.errors;return{appKey:o,publishId:this.publishId,sessionId:this.sessionId,anonymousId:this.anonymousId,currentPageProductId:this.currentPageProductId,isMobile:this.getIsMobile(),pageUrl:s,storeUrl:i,appUrl:i,googleAnalyticsID:r,projectId:t,playlist:n,timestamp:new Date().toISOString(),parentUrl:window.location.href,playerType:this.playerType,customParams:a?JSON.stringify(a):void 0,collectionId:this.collectionId,...e}}sendEventToAllSources(e){(0,c.createPlayerEvent)(e),(0,s.sendAnalyticsToExternalSource)({data:{...e,name:e.eventName}})}sendEventImmediately(e={},t=!1){let o=this.getAnalyticsParams(e);(0,c.sendEvent)(o),t||(0,s.sendAnalyticsToExternalSource)({data:{...o,name:o.eventName}})}sendEvent(e={},t=!1){if(!(0,p.verifyUserConsent)())return;let o=this.getAnalyticsParams(e);o.eventName===n.EVENT_NAMES.onYouClick&&console.log("Analytics::sendEvent::params",o),(0,c.createPlayerEvent)(o),t||(0,s.sendAnalyticsToExternalSource)({data:{...o,name:o.eventName}})}handlePageView(){(0,s.setImpressionByPublishId)(this.publishId,!1),this.sendEvent({eventName:n.EVENT_NAMES.pageView})}handleEmbedView(){(0,s.setImpressionByPublishId)(this.publishId,!0),this.sendEvent({eventName:n.EVENT_NAMES.embedView})}handleOnYouClick(){(0,s.setImpressionByPublishId)(this.publishId,!0),(0,d.setSessionId)(this.sessionId),this.sendEvent({eventName:n.EVENT_NAMES.onYouClick})}handleSessionStart(){let e=this.getAnalyticsParams({eventName:n.EVENT_NAMES.sessionStart});this.sendEventToAllSources(e),(0,i.handleTolstoyStart)({data:{...e,name:a.PLAYER_EVENT_NAMES.sessionStart}}),window.postMessage({...e,name:a.PLAYER_EVENT_NAMES.sessionStart},"*")}handleVideoLoaded(e={}){let t=this.getAnalyticsParams({...e,eventName:n.EVENT_NAMES.videoLoaded});this.sendEventToAllSources(t)}handleVideoWatched(e={}){let t=this.getAnalyticsParams({...e,eventName:n.EVENT_NAMES.videoWatched});this.sendEventToAllSources(t)}}}),s("igWUq",function(t,o){let n;e(t.exports,"handleTolstoyStart",function(){return h}),e(t.exports,"handleWatchedProductIds",function(){return f}),e(t.exports,"handleOpenIntegration",function(){return S}),e(t.exports,"handleHideIntegration",function(){return y});var s=r("50h3S");r("bvKjB");var i=r("8ptJJ"),a=r("519R9"),l=r("aEodP"),d=r("93NPo"),c=r("eSOI5");let u="",p=e=>{let t=document.querySelector("#smile-ui-container");e&&(u=t?.style.display||""),t?.style?.setProperty("display",e||u)},E=e=>{let t=0;return o=>{try{o()}catch(n){try{if(!(0,d.verifyUserConsent)())return;fetch("https://api.gotolstoy.com/events/event",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({eventName:"widgetError",text:n.message,timestamp:new Date().toISOString(),parentUrl:window.location.href,appKey:e.data.appKey,publishId:e.data.publishId,sessionId:e.data.sessionId,source:e.data.name,answerKey:`${t}`,currentPageProductId:o.toString(),formData:`${(n&&n.stack||"").slice(0,1999)}`})})}catch(e){(0,d.logDevelopmentError)(e)}}finally{t++}}},h=e=>{if(e.data.name===s.PLAYER_EVENT_NAMES.sessionStart||e.data.name===s.PLAYER_EVENTS.autoplayStart){let t=E(e);t(()=>(0,c.setPublishId)(e.data.publishId)),t(()=>(0,c.setTolstoyInteractionDate)(e.data.appKey)),t(()=>(0,c.setSessionId)(e.data.sessionId)),t(()=>(0,c.updateTolstoyActivitySessionIdByPublishId)(e.data.publishId,e.data.sessionId)),t(()=>p("none")),t(()=>g(e.data.anonymousId))}},g=e=>{window.Shopify&&(0,a.default).postMessage({eventName:l.INTERNAL_EVENTS.setAnonymousIdToCart,anonymousId:e})},f=({data:{name:e,publishId:t,productIds:o}={}})=>{if(e===i.TOLSTOY_WATCHED_PRODUCT_IDS_MESSAGE)for(let e of o)(0,c.pushTolstoyViewedProducts)({productId:e,publishId:t})},S=e=>{m[e.data.name]&&m[e.data.name](e.data)},y=e=>{I[e.data.name]&&setTimeout(()=>I[e.data.name](),500)},T=e=>{document.head.insertAdjacentHTML("beforeend",`<style>${e} { visibility: hidden; display: none; }</style>`)},m={[s.PLAYER_EVENT_NAMES.openGorgias]:()=>{window.GorgiasChat&&(window.GorgiasChat.open?.(),window.tolstoyWidget.hide(),document.head.insertAdjacentHTML("beforeend","<style>#gorgias-chat-container iframe#chat-button { visibility: visible !important; display: block !important; }</style>"))},[s.PLAYER_EVENT_NAMES.openIntercom]:()=>{let e=setTimeout(()=>clearInterval(t),9e3),t=setInterval(()=>{window.Intercom&&(window.Intercom("show"),window.tolstoyWidget.hide(),clearInterval(t),clearTimeout(e),window.Intercom("onHide",()=>{window.tolstoyWidget.show()}))})},[s.PLAYER_EVENT_NAMES.openTawkTo]:()=>{window.Tawk_API&&(window.Tawk_API.maximize(),window.tolstoyWidget.hide())},[s.PLAYER_EVENT_NAMES.openLiveChat]:()=>{window.LiveChatWidget&&(window.LiveChatWidget.call("maximize"),window.tolstoyWidget.hide())},[s.PLAYER_EVENT_NAMES.openHubSpot]:()=>{window.HubSpotConversations&&window.HubSpotConversations.widget&&(window.HubSpotConversations.widget.open(),window.tolstoyWidget.hide())},[s.PLAYER_EVENT_NAMES.openDrift]:()=>{window.drift&&(window.drift.api.toggleChat(),window.tolstoyWidget.hide())},[s.PLAYER_EVENT_NAMES.openZendesk]:()=>{window.zE&&(window.zE("messenger","open"),document.querySelector('[title="Button to launch messaging window"]')?.style?.setProperty("display","block"),window.tolstoyWidget.hide())},[s.PLAYER_EVENT_NAMES.openHelpScout]:()=>{window.Beacon&&(window.Beacon("open"),window.tolstoyWidget.hide(),window.Beacon("config",{display:{zIndex:"99999"}}))},tolstoyOpenFreshChat:()=>{window.fcWidget&&(window.fcWidget.show(),window.fcWidget.open(),window.tolstoyWidget.hide())},tolstoyOpenReamaze:()=>{if(!n&&window.Reamaze?.popup){window.Reamaze.popup(),window.tolstoyWidget.hide();return}window._support&&n&&window.Reamaze?.reload&&(window._support.ui=n,window.Reamaze.reload(),n=null,window.tolstoyWidget.hide())},tolstoyOpenAda:()=>{window.adaEmbed&&(window.adaEmbed.toggle(),window.tolstoyWidget.hide())},tolstoyOpenTidio:()=>{window.tidioChatApi&&(window.tidioChatApi.show(),window.tidioChatApi.open(),window.tolstoyWidget.hide())},tolstoyOpenCertainly:e=>{if(window.certainly)switch(window.certainly.widgetStatus({action:"open"}),window.tolstoyWidget.hide(),e.data.key){case"PmkMI":window.certainly.goTo({module:"670442"});break;case"_23Hl":window.certainly.goTo({module:"670178"});break;case"P9rfq":window.certainly.goTo({module:"670179"})}}},I={[s.PLAYER_EVENT_NAMES.hideGorgias]:()=>{window.GorgiasChat&&(window.GorgiasChat.close?.(),document.head.insertAdjacentHTML("beforeend","<style>#gorgias-chat-container iframe#chat-button { visibility: hidden; display: none; }</style>"))},[s.PLAYER_EVENT_NAMES.hideIntercom]:()=>{let e=setTimeout(()=>clearInterval(t),9e3),t=setInterval(()=>{window.Intercom&&(window.Intercom("update",{hide_default_launcher:!0}),clearInterval(t),clearTimeout(e))},100)},[s.PLAYER_EVENT_NAMES.hideTawkTo]:function(){window.Tawk_API&&window.Tawk_API.hideWidget()},[s.PLAYER_EVENT_NAMES.hideLiveChat]:function(){window.LiveChatWidget&&window.LiveChatWidget.call("hide")},[s.PLAYER_EVENT_NAMES.hideHubSpot]:function(){window.HubSpotConversations&&window.HubSpotConversations.widget&&window.HubSpotConversations.widget.close()},[s.PLAYER_EVENT_NAMES.hideDrift]:()=>{window.drift&&window.drift.api.widget.hide()},[s.PLAYER_EVENT_NAMES.hideZendesk]:()=>{let e=setTimeout(()=>clearInterval(t),5e3),t=setInterval(()=>{let o=document.querySelector('[title="Button to launch messaging window"]'),n=document.querySelector('[title="Message from company"]');o?.style?.setProperty("display","none"),n?.parentElement?.style?.setProperty("display","none"),o&&n&&(clearInterval(t),clearTimeout(e))},100);window.zE&&window.zE("messenger","close")},[s.PLAYER_EVENT_NAMES.hideHelpScout]:()=>{window.Beacon&&window.Beacon("config",{display:{zIndex:"0"}})},tolstoyHideFreshChat:()=>{window.fcWidget&&(window.fcWidget.close(),window.fcWidget.hide(),window.tolstoyWidget.show())},tolstoyHideReamaze:()=>{window._support?.ui&&window.Reamaze?.reload&&(n=window._support.ui,delete window._support.ui,window.Reamaze.reload(),window.tolstoyWidget.show())},tolstoyHideAda:()=>{document.head.insertAdjacentHTML("beforeend","<style>#ada-button-frame { display: none; }</style>")},tolstoyHideVfChat:()=>{T("#vfChat+div"),T("#vfChat+div+div")},tolstoyHideTidio:()=>{window.tidioChatApi&&window.tidioChatApi.close()},tolstoyHideCertainly:()=>{window.certainly&&window.certainly.widgetStatus({action:"hide"})}}}),s("8ZCcc",function(t,o){e(t.exports,"getFeatureSettings",function(){return s}),e(t.exports,"getFeatureIsEnabled",function(){return i}),e(t.exports,"getIsPlayerLazy",function(){return a}),e(t.exports,"getPlayerOrigin",function(){return l}),e(t.exports,"getIsFallbackVideoDisabled",function(){return d});var n=r("dQiGr");let s=({config:e,featureKey:t})=>e?.featureSettings?.[t],i=({config:e,featureKey:t})=>!!e?.featureSettings?.[t],a=(e={})=>{let t=s({config:e,featureKey:n.FEATURE_WIDGET_LOADING});return t?.playerLazy},l=(e={})=>{let t=s({config:e,featureKey:n.FEATURE_WIDGET_LOADING});return t?.playerOrigin},d=(e={})=>{let t=s({config:e,featureKey:n.FEATURE_WIDGET_FALLBACK_VIDEO});return t?.dontUseFallback}}),s("6MJM3",function(t,o){e(t.exports,"getBaseUrl",function(){return d}),e(t.exports,"getImageUrlByStep",function(){return c}),e(t.exports,"setVideoSourceOnEnd",function(){return u});var n=r("e8kzi"),s=r("kq83N"),i=r("j2c9o"),a=r("iG8TK");let l=({isMobile:e,isStory:t,isPlayInTileFirst:o,isTile:n})=>o||n?"_640.mp4":e||t?"_preview.mp4":"_preview_embed.mp4",d=({step:e,isStory:t,isPlayInTileFirst:o,height:r=a.DEFAULT_TILE_HEIGHT,isTile:s})=>{let{videoOwner:i,stockAsset:d,videoId:c}=e,u=l({isMobile:window.innerWidth<=450,isStory:t,isPlayInTileFirst:o,isTile:s}),p=d?.videoUrl,E=!!d?.shopifyFileId,h=d?.previewUrl,g=d?.hasOriginal,f=d?.gifUrl;if(h&&!o&&r<480&&!s)return h;if(p&&E)return p;if(p&&!E){if(p?.includes("vimeo"))return p;let e=p.split(".mp4")[0];return`${e}${u}`}if(f&&E&&!g){let e=f.split(".mp4")[0];return`${e}${u}`}return(0,n.buildUrl)({ownerId:i,assetId:c,extension:u})},c=(e,t,o=s.IMAGE_DIMENSIONS["480x480"])=>{let r=window.innerWidth<=450?i.WEBP_AVATAR_EXTENSION:i.WEBP_EXTENSION;return(0,n.getImageUrl)({step:e,extension:r,posterSettings:t,size:o})},u=(e,t)=>{e.addEventListener("ended",()=>{if(e.autoplay){e.src="";return}e.src=t},{once:!0})}}),s("e8kzi",function(t,o){e(t.exports,"buildUrl",function(){return i}),e(t.exports,"getPosterUrlFromStockAsset",function(){return a}),e(t.exports,"getImageUrl",function(){return l});var n=r("2Aomz"),s=r("kq83N");let i=({path:e=`${n.VIDEO_OUTPUT}/public`,ownerId:t="",assetId:o="",suffix:r="",extension:s=""})=>`${e}/${t}/${o}/${o}${r}${s}`,a=({stockAsset:e={},posterSettings:t={}})=>{let{useShopifyPoster:o=!0}=t,{shopifyPosterUrl:n,posterUrl:r}=e||{};return n&&o?n:r},l=({step:e,extension:t,posterSettings:o,size:r=s.IMAGE_DIMENSIONS["250x250"],custom:a={condition:"",callback:""},path:l=`${n.VIDEO_OUTPUT}/public`})=>{let{videoOwner:d,videoId:c,stockAsset:u={},mediaAssets:p}=e;if(!c)return"";let{avatarUrl:E,posterUrl:h,hasOriginal:g,shopifyPosterUrl:f}=u||{},{shopifyAttributes:S={},shopifySpotlightAttributes:y={},useShopifyPoster:T=!1}=o||{},m={...S,...y},I=!!Object.keys(m)?.length;if(h)return h;if(p&&p?.images&&p?.images[r]&&!(f&&T&&I))return p.images[r];let N=!g&&(E||h);return h?.endsWith(t)||h&&!g?h:a?.condition&&a?.callback&&a.condition({posterUrl:h,avatarUrl:E,extension:t,isDuplicated:N})?a.callback(u):i({path:l,ownerId:d,assetId:c,extension:t})}}),s("kq83N",function(t,o){e(t.exports,"DEFAULT_IMAGE_EXTENSION",function(){return n}),e(t.exports,"ASSET_TYPE",function(){return r}),e(t.exports,"IMAGE_SIZE",function(){return s}),e(t.exports,"IMAGE_SIZE_SUFFIX",function(){return i}),e(t.exports,"IMAGE_DIMENSIONS",function(){return a});let n=".webp",r={VIDEO:"video",IMAGE:"image",GALLERY:"gallery"},s={XS:250,S:480,M:960,L:1280,XL:1920},i={[s.XS]:"_250",[s.S]:"_480",[s.M]:"_960",[s.L]:"_1280",[s.XL]:"_1920"},a={"250x140":"250x140","250x250":"250x250","480x480":"480x480","960x540":"960x540"}}),s("j2c9o",function(t,o){e(t.exports,"WEBP_AVATAR_EXTENSION",function(){return n}),e(t.exports,"WEBP_EXTENSION",function(){return r}),e(t.exports,"JPG_AVATAR_EXTENSION",function(){return s}),e(t.exports,"JPG_EXTENSION",function(){return i});let n=".avatar.0000000.webp",r=".401.0000000.webp",s=".avatar.0000000.jpg",i=".0000000.jpg"}),s("e7CwX",function(e,t){e.exports=r("1rN27")(r("jHnDr").resolve("jzpb5")).then(()=>r("2apiB"))}),s("1rN27",function(e,t){var o=r("JNMYe");e.exports=o(function(e){return new Promise(function(t,o){if([].concat(document.getElementsByTagName("script")).some(function(t){return t.src===e})){t();return}var n=document.createElement("link");n.href=e,n.rel="preload",n.as="script",document.head.appendChild(n);var r=document.createElement("script");r.async=!0,r.type="text/javascript",r.src=e,r.onerror=function(t){var n=TypeError("Failed to fetch dynamically imported module: ".concat(e,". Error: ").concat(t.message));r.onerror=r.onload=null,r.remove(),o(n)},r.onload=function(){r.onerror=r.onload=null,t()},document.getElementsByTagName("head")[0].appendChild(r)})})}),s("JNMYe",function(e,t){var o={},n={},r={};e.exports=function(e,t){return function(s){var i=function(e){switch(e){case"preload":return n;case"prefetch":return r;default:return o}}(t);return i[s]?i[s]:i[s]=e.apply(null,arguments).catch(function(e){throw delete i[s],e})}}}),s("krrJN",function(e,t){e.exports=r("1rN27")(r("jHnDr").resolve("89rZX")).then(()=>r("hdNOp"))}),s("fGHMu",function(e,t){e.exports=Promise.all([r("9FDC1")(r("jHnDr").resolve("ls8QA")),r("1rN27")(r("jHnDr").resolve("cDpG9")),r("1rN27")(r("jHnDr").resolve("34FYC"))]).then(()=>r("2LevF"))}),s("9FDC1",function(e,t){var o=r("JNMYe");e.exports=o(function(e){return new Promise(function(t,o){if([].concat(document.getElementsByTagName("link")).some(function(t){return t.href===e&&t.rel.indexOf("stylesheet")>-1})){t();return}var n=document.createElement("link");n.rel="stylesheet",n.href=e,n.onerror=function(e){n.onerror=n.onload=null,n.remove(),o(e)},n.onload=function(){n.onerror=n.onload=null,t()},document.getElementsByTagName("head")[0].appendChild(n)})})}),s("bjM0J",function(e,t){e.exports=Promise.all([r("9FDC1")(r("jHnDr").resolve("1U8tk")),r("1rN27")(r("jHnDr").resolve("cDpG9")),r("1rN27")(r("jHnDr").resolve("l1VTG"))]).then(()=>r("8EN4e"))}),s("bqpZk",function(e,t){e.exports=Promise.all([r("9FDC1")(r("jHnDr").resolve("cGSvp")),r("1rN27")(r("jHnDr").resolve("jiIH5"))]).then(()=>r("2IbOs"))}),s("kzluS",function(e,t){e.exports=Promise.all([r("9FDC1")(r("jHnDr").resolve("6iLLd")),r("1rN27")(r("jHnDr").resolve("lCIdQ"))]).then(()=>r("a0Gsc"))}),s("dtdnN",function(e,t){e.exports=Promise.all([r("9FDC1")(r("jHnDr").resolve("ksyNr")),r("1rN27")(r("jHnDr").resolve("6mZ8R"))]).then(()=>r("li39R"))}),s("a78DZ",function(t,o){e(t.exports,"default",function(){return s});var n=r("eSOI5"),s=class{addHours(e,t=new Date){return t.setTime(t.getTime()+36e5*e),t}getTolstoyViewers(){let e=(0,n.getTolstoyViewers)();for(let[t,o]of Object.entries(e)){let n=o.restrictionLimits;n&&n?.time&&new Date(n?.time)<=new Date&&delete e[t].restrictionLimits}let t=JSON.stringify(e);return(0,n.setTolstoyViewers)(e),t}updateRestrictions(e,t){let o=(0,n.getTolstoyViewers)(),r=o[t]?.restrictionLimits;if(!r||r?.type!==e)return;let s=r[e];r[e]=s?s+1:1,r.limit&&r.clickLimit===r[e]&&(r.time=this.addHours(r?.limit)),o[t].restrictionLimits=r,(0,n.setTolstoyViewers)(o)}updateRules(e){let t=e?.publishId||void 0,o=e?.limit,r=(0,n.getTolstoyViewers)(),s=r[t],i=s?.restrictionLimits;s?s.impressionCount+=1:s={impressionCount:1,playCount:0};let a=r.undefined;if(a?a.impressionCount+=1:a={impressionCount:1,playCount:0},o){let e={limit:Number(o.timeLimit),type:o.type,clickLimit:Number(o.clickLimit)};i&&(e={...i,...e}),s.restrictionLimits=e}else i&&(s.restrictionLimits=null);r[t]=s,r.undefined=a,(0,n.setTolstoyViewers)(r)}}}),s("7Tj0o",function(t,o){e(t.exports,"default",function(){return r});class n{static isValidUrl(e){return!!e&&(!!(e.startsWith("tel:")||e.startsWith("mailto:"))||null!==e.match(/(http(s)?:\/\/.)?(www\.)?[-a-zA-Z0-9@:%._+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_+.~#?&//=]*)/g))}static isAndroid(){return navigator.userAgent.toLowerCase().indexOf("android")>-1}static isInIframe(){try{return window.self!==window.top}catch(e){return!0}}static isIos(){return/iPad|iPhone|iPod/.test(navigator.platform)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1}static getMobileOperatingSystem(){let e=navigator.userAgent||navigator.vendor||window.opera;return/windows phone/i.test(e)?"Windows Phone":/android/i.test(e)?"Android":/iPad|iPhone|iPod/.test(e)&&!window.MSStream?"iOS":navigator.userAgent.match(/Mac/)&&navigator.maxTouchPoints&&navigator.maxTouchPoints>2?"ipad":null}static isMobile(){return null!=n.getMobileOperatingSystem()}static isSafari(){return void 0!==window.safari}static enforceProtocol(e,t="https"){return e.startsWith("http")||e.startsWith("//")||e.startsWith("tel:")||e.startsWith("mailto:")?e:`${t}://${e}`}static removeProtocol(e){return e.replace(/(^\w+:|^)\/\//,"")}static stripUrl(e){return n.removeProtocol(e).replace(/^www./,"").replace(/\/$/,"")}}var r=n}),s("k3iEx",function(t,o){e(t.exports,"isShopifyStore",function(){return h}),e(t.exports,"getCustomerId",function(){return y}),e(t.exports,"getEmailFromParams",function(){return m}),e(t.exports,"getTolstoyAutoOpen",function(){return I}),e(t.exports,"getTolstoyAutoOpenOnYou",function(){return N}),e(t.exports,"getTolstoyStartVideo",function(){return w}),e(t.exports,"getTolstoyMoneyFormat",function(){return _}),e(t.exports,"getIframeSource",function(){return b});var n=r("eSOI5"),s=r("2Aomz"),i=r("kCbDV"),a=r("37dzN"),l=r("izL3O"),d=r("8ZCcc"),c=r("lUrCX"),u=r("lY4N9"),p=r("93NPo");let E=(e,t,o)=>{if(o)return`${s.ON_YOU_URL}`;let n=(0,d.getPlayerOrigin)(e);if(n){let t=(0,p.getSafeParameter)("td"),o=g(e);return t&&o?n.replace("2.0.0","2.0.0-ls"):o?n.replace("2.0.0","2.0.0-l"):t?n.replace("2.0.0","2.0.0-s"):n}let r=`${s.PLAYER_URL}`;return t&&(r+="/feed"),e.publishId&&(r+=`/${e.publishId}`),r},h=()=>!!(window.Shopify&&window.Shopify?.routes),g=e=>e.playerLazy||(0,p.getSafeParameter)("pl"),f=e=>e?.featureSettings?.[a.FEATURE_PLAYER_VERSION]?.version,S=e=>e?.carouselEmbed?.carouselPlayInTileFirst?i.IN_TILE_CAROUSEL_EMBED_WIDGET:"",y=()=>window._st?.cid||window.ShopifyAnalytics?.meta?.page?.customerId||"",T=()=>new URLSearchParams(window.location.search).get("authToken"),m=()=>window.tolstoyUserInfo?.email||window.tolstoyUser,I=()=>(0,p.getSafeParameter)(i.URL_PARAMETERS.tolstoyAutoOpen)||window.tolstoyAutoOpen,N=()=>(0,p.getSafeParameter)(i.URL_PARAMETERS.tolstoyAutoOpenOnYou)||window.tolstoyAutoOpenOnYou,w=()=>(0,p.getSafeParameter)(i.URL_PARAMETERS.tolstoyStartVideo)||window.tolstoyStartVideo,_=()=>{let e=window.tolstoyMoneyFormat;return e?encodeURIComponent(e):""},A=({data:e,isFeed:t,isOnYou:o,email:r,isDynamic:s,modalId:i,tolstoyStartVideo:a})=>{let E=`${window.location.origin}${window.location.pathname}`.slice(0,1999),I=[`url=${E}`,`modalId=${i}`];e.publishId&&I.push(`publishId=${e.publishId}`);let N=T();N&&I.push(`authToken=${N}`);let w=r||m();if(w&&I.push(`email=${encodeURIComponent(w)}`),e.productId&&I.push(`productId=${e.productId}`),o){let e=localStorage.getItem("tolstoy-anonymousId"),t=window.Shopify?.shop||(0,l.getShop)(),o=Array.from(document.querySelectorAll("div")||{}).find(e=>"Size & Fit"===e.textContent.trim()),r=Array.from(o?.nextElementSibling?.childNodes||{}).filter(e=>e.nodeType===Node.TEXT_NODE).map(e=>e.textContent.trim()).join(" ");t&&I.push(`appUrl=${t}`),e&&I.push(`tolstoyAnonymousId=${e}`);let s=(0,n.getSessionId)();return s&&I.push(`sessionId=${s}`),r&&I.push(`productFitDetails=${encodeURIComponent(r)}`),I}e.currentProductDbId&&I.push(`currentPageDbProductId=${e.currentProductDbId}`);let A=window.Shopify?.shop||"",b=!!(h()&&A);if(I.push("host",`safari=${!!window?.safari}`,`dontDownload=${!!e.dontDownload}`,`playerType=${e.playerType}`,`isShopifyStore=${b}`,`shopifyStoreUrl=${A}`,`ai=${(0,n.getAndSetAnonymousId)()}`),h()){let e=window.Shopify?.routes?.root;e&&I.push(`shopifyRootRoute=${e}`)}if(window.tolstoyUserInfo?.name&&I.push(`name=${encodeURIComponent(window.tolstoyUserInfo.name)}`),window.tolstoyUserInfo?.phone&&I.push(`phone=${encodeURIComponent(window.tolstoyUserInfo.phone)}`),window.tolstoyMoneyFormat){let e=_();I.push(`tolstoyMoneyFormat=${e}`)}a&&I.push(`tolstoyStartVideo=${a}`),e.testGroup&&I.push(`group=${e.testGroup}`),e.sneakpeek&&I.push("sneakpeek"),e.sneakpeek_hidden&&I.push("sneakpeek_hidden"),e.token&&I.push(`token=${e.token}`),e.gclid&&I.push(`gclid=${e.gclid}`),e.widgetDelay&&I.push("delay"),!1===e.isShoppable&&I.push(`isShoppable=${e.isShoppable}`),e.si&&I.push(`si=${e.si}`);let v=(0,p.getSafeParameter)("td");v&&I.push(`td=${v}`);let C=g(e);C&&I.push(`pl=${C}`);let L=f(e);L&&I.push(`pv=${L}`);let R=S(e);R&&I.push(`playerVariant=${R}`),s&&I.push("isDynamic=true");let O=y();O&&I.push(`customerId=${O}`);let P=(0,c.getUrlCustomParams)();P.size>0&&I.push(P.toString()),(0,u.getIsTapcart)()&&I.push("isTapcart=true");let M=(0,d.getPlayerOrigin)(e);return M&&e.publishId&&I.push(`publishId=${e.publishId}`),M&&t&&I.push("isFeed=true"),window.tolstoySettings?.shouldUseCache&&I.push(`shouldUseCache=${window.tolstoySettings?.shouldUseCache}`),window.tolstoySettings?.cacheVersion&&I.push(`cacheVersion=${window.tolstoySettings?.cacheVersion}`),(0,p.verifyUserConsent)()||I.push("userConsent=false"),I},b=({data:e,isFeed:t,isOnYou:o,email:n,isDynamic:r,modalId:s,tolstoyStartVideo:i})=>{let a=E(e,t,o),l=A({data:e,isFeed:t,isOnYou:o,email:n,isDynamic:r,modalId:s,tolstoyStartVideo:i});return`${a}?${l.join("&")}`}}),s("37dzN",function(t,o){e(t.exports,"FEATURE_PLAYER_VERSION",function(){return n});let n="player-version"}),s("enQtM",function(e,t){e.exports=Promise.all([r("9FDC1")(r("jHnDr").resolve("isfCu")),r("1rN27")(r("jHnDr").resolve("cDpG9")),r("1rN27")(r("jHnDr").resolve("aKM9X"))]).then(()=>r("4FBx6"))}),s("bQxIb",function(e,t){e.exports=Promise.all([r("9FDC1")(r("jHnDr").resolve("koqqC")),r("1rN27")(r("jHnDr").resolve("cDpG9")),r("1rN27")(r("jHnDr").resolve("b9uE3"))]).then(()=>r("9Du8u"))}),s("5GzNL",function(t,o){e(t.exports,"PUBLIC_CLASSES",function(){return n}),e(t.exports,"TOLSTOY_TV_CONTAINER_ID",function(){return r}),e(t.exports,"TOLSTOY_TV_ID",function(){return s}),e(t.exports,"AB_TEST_PUBLISH_IDS",function(){return i});let n={tvContainer:"tolstoy-video-page"},r="tolstoy-tv-container",s="tolstoy-tv",i={}}),s("6TwUM",function(e,t){e.exports=Promise.all([r("9FDC1")(r("jHnDr").resolve("3xAff")),r("1rN27")(r("jHnDr").resolve("dTIhU"))]).then(()=>r("3c1EV"))}),s("kHyIS",function(t,o){e(t.exports,"EXTERNAL_EVENTS_TO_SUBSCRIBE",function(){return n}),e(t.exports,"EXTERNAL_EVENTS_TO_POST",function(){return r}),e(t.exports,"ALLOWED_EXTERNAL_EVENTS_TO_SUBSCRIBE",function(){return s}),e(t.exports,"ALLOWED_EXTERNAL_EVENTS_TO_POST",function(){return i});let n={addToCart:"tolstoy_add_to_cart",spotlightCarouselQuickShopClick:"tolstoy_spotlight_carousel_quick_shop_click",productCardClick:"tolstoy_product_card_click"},r={addToCartSuccess:"tolstoy_add_to_cart_success",addToCartError:"tolstoy_add_to_cart_error",rejectCookiePolicy:"tolstoy_reject_cookie_policy",tolstoyZIndexChange:"tolstoy_z_index_change",urlLocaleUpdate:"tolstoy_url_locale_update",productUpdate:"tolstoy_product_update"},s=Object.values(n),i=new Set([r.addToCartSuccess,r.addToCartError,r.rejectCookiePolicy,r.tolstoyZIndexChange,r.urlLocaleUpdate,r.productUpdate])}),s("k6zg1",function(t,o){e(t.exports,"getIsBaseCurrency",function(){return n}),e(t.exports,"isShopifyCdnUrl",function(){return r});let n=()=>1===Number(window.Shopify?.currency?.rate),r=e=>"string"==typeof e&&e.includes("cdn.shopify.com")}),s("4dQPj",function(t,o){e(t.exports,"default",function(){return h});var n=r("aEodP"),s=r("8ptJJ"),i=r("519R9"),a=r("e3391");let l={},d={},c={},u=[];class p{constructor(){if(p.instance)return p.instance;p.instance=this}registerIframe({modalId:e,modalIframe:t}){l[e]=t}postInternalMessage({modalId:e,data:t}){delete t.modalId,c[(0,i.default).postMessage(t)]=e}handleModalMessagingReady({modalId:e}){d[e]=!0;let t=l[e];for(let o of u){let{transmissionId:n}=o,r=c[n],s=!r,i=r===e;(s||i)&&this.postMessageToIframe({iframe:t,message:o})}}eventHandler=({data:e={}})=>{let{modalId:t,eventName:o}=e;if(t)switch(o){case n.INTERNAL_EVENTS.addToCart:case n.INTERNAL_EVENTS.openRebuyCart:case n.INTERNAL_EVENTS.openKendoModal:case n.INTERNAL_EVENTS.getProductsMetafields:case n.INTERNAL_EVENTS.productCardClick:case n.INTERNAL_EVENTS.loginWithMultipassUrlRequest:case n.INTERNAL_EVENTS.cartItemQuantityChange:case n.INTERNAL_EVENTS.cartDataRequest:case n.INTERNAL_EVENTS.productRecommendationsRequest:case n.INTERNAL_EVENTS.requestProductsUpdate:case n.INTERNAL_EVENTS.moveToUrl:case n.INTERNAL_EVENTS.showFeedProductModal:case n.INTERNAL_EVENTS.reportModalOpen:case n.INTERNAL_EVENTS.reportModalClose:case s.TOLSTOY_PLAYER_READY_MESSAGE:return this.postInternalMessage({modalId:t,data:e});case n.INTERNAL_EVENTS.modalMessagingReady:return this.postInternalMessage({modalId:t,data:e}),this.handleModalMessagingReady({modalId:t});case n.INTERNAL_EVENTS.toggleFeedCloseButton:return this.postInternalMessage({modalId:t,data:e});default:return null}};internalEventHandler=({data:e})=>{this.postMessageToModal(e)};postMessageToIframe({iframe:e,message:t}){e.contentWindow?.postMessage(t,"*")}postMessageToAllIframes({message:e}){for(let[t,o]of(u.push(e),Object.entries(l)))d[t]&&this.postMessageToIframe({iframe:o,message:e})}postMessageToModal(e){let{transmissionId:t,shouldEndTransmission:o=!0,...n}=e,r=c[t];if(!r)return this.postMessageToAllIframes({message:n});if(!d[r]){u.push(e);return}let s=l[r];this.postMessageToIframe({iframe:s,message:n}),o&&delete c[t]}initInternalMessagingSubscriptions=()=>{(0,i.default).subscribeMultipleEvents({eventNames:a.INTERNAL_MESSAGES_TO_SUBSCRIBE,callback:this.internalEventHandler})};init(){this.initInternalMessagingSubscriptions(),window.addEventListener("message",this.eventHandler)}}let E=new p;Object.freeze(E);var h=E}),s("e3391",function(t,o){e(t.exports,"INTERNAL_MESSAGES_TO_SUBSCRIBE",function(){return s});var n=r("aEodP");let s=[n.INTERNAL_EVENTS.addToCartError,n.INTERNAL_EVENTS.addToCartSuccess,n.INTERNAL_EVENTS.addToCartSoldOut,n.INTERNAL_EVENTS.isRebuyAppInstalled,n.INTERNAL_EVENTS.isAfterpayAppInstalled,n.INTERNAL_EVENTS.openRebuyCart,n.INTERNAL_EVENTS.returnProductsMetafields,n.INTERNAL_EVENTS.rejectCookiePolicy,n.INTERNAL_EVENTS.productCardClickSubscribed,n.INTERNAL_EVENTS.isTapcart,n.INTERNAL_EVENTS.urlLocaleUpdate,n.INTERNAL_EVENTS.loginWithMultipassUrlResponse,n.INTERNAL_EVENTS.cartDataResponse,n.INTERNAL_EVENTS.cartItemQuantityChangeSuccess,n.INTERNAL_EVENTS.cartItemQuantityChangeError,n.INTERNAL_EVENTS.productRecommendationsResponse,n.INTERNAL_EVENTS.productUpdateResponse,n.INTERNAL_EVENTS.isNonBaseCurrency,n.INTERNAL_EVENTS.eventListenersInitialized]}),r("jHnDr").register(r("2372k").getBundleURL("fWNwr"),JSON.parse('["fWNwr","widget.js","jzpb5","widget.events.js","89rZX","carousel-loader.js","izN8B","carousel-skeleton.js","1NB7b","CarouselSkeleton.63918fc0.js","ew0qU","CarouselSkeleton.f266f97b.css","dj7hR","carousel.js","cDpG9","Carousel.6f2277bc.js","kFOMR","Carousel.d7353ae6.css","2SjbV","spotlight-carousel-controller.js","2GnTj","SpotlightCarouselController.797a536e.css","34FYC","story.js","ls8QA","Story.ef5ade25.css","l1VTG","embed.js","1U8tk","Embed.9bcdb556.css","jiIH5","tile.js","cGSvp","Tile.864911ff.css","lCIdQ","collection-tile-controller.js","6iLLd","CollectionTileController.821f8f4a.css","6mZ8R","collection-page-tile-controller.js","ksyNr","CollectionPageTileController.104ab420.css","aKM9X","centered-modal.js","isfCu","CenteredModal.ce242a2e.css","b9uE3","bubble.js","koqqC","Bubble.8f869649.css","dTIhU","t-v.js","3xAff","TV.8d0c699d.css"]'));var i=r("aQK74");let a={PDP_CAROUSEL:"pdp-carousel",VIDEO_PAGE:"video-page"},l={HEADER:"header",HEADER_AND_BOTTOM_NAVBAR:"header-and-bottom-navbar",CUSTOM_SCREEN:"custom-screen",CUSTOM_SCREEN_AND_BOTTOM_NAVBAR:"custom-screen-and-bottom-navbar"},d=e=>document.documentElement.style.setProperty("height",`${e}px`,"important"),c=()=>navigator.userAgent.toLowerCase().includes("android"),u=e=>{let t=window.screen.availHeight,o=window.Tapcart.variables.device.windowHeight;switch(e){case l.HEADER:case l.HEADER_AND_BOTTOM_NAVBAR:return o;case l.CUSTOM_SCREEN:return t-100;case l.CUSTOM_SCREEN_AND_BOTTOM_NAVBAR:return t-184;default:return o||t}},p=e=>{let t=window.screen.availHeight,o=window.Tapcart.variables.device.windowHeight;switch(e){case l.HEADER:return o;case l.HEADER_AND_BOTTOM_NAVBAR:return o-75;case l.CUSTOM_SCREEN:return t-90;case l.CUSTOM_SCREEN_AND_BOTTOM_NAVBAR:return t-175;default:return o||t}},E=e=>c()?u(e):p(e),h=(e,t)=>{d(E(t.navType))},g=e=>`
    <style>
      .tolstoy-video-page iframe {
        display: block !important;
      }
    </style>
    <tolstoy-video-page
      id="tolstoy-tv-container"
      class="tolstoy-video-page"
      data-publish-id="${e}"
    ></tolstoy-video-page>
  `,f=(e={})=>{let{height:t=490}=e,o=0,n=setInterval(function(){o++;let e=document.querySelector(".tolstoy-carousel-container"),r=document.querySelector(".tolstoy-carousel");e&&r?(r.style.display="block",d(t),clearInterval(n)):o>=50&&clearInterval(n)},200)},S=(e,t)=>{d(0),f(t)},y=e=>{let t=window?.Tapcart?.variables?.product?.id;return`
    <style>
      * {
        box-sizing: border-box;
        padding: 0;
        margin: 0;
        font-family: Helvetica;
      }
      
      .tolstoy-carousel iframe {
        display: block !important;
      }
    </style>
    <tolstoy-carousel
      class="tolstoy-carousel"
      data-publish-id="${e}"
      style="display: none"
      ${t?`data-product-id="${t}"`:""}
    ></tolstoy-carousel>
  `},T=async(e,t)=>{switch(t.blockType){case a.PDP_CAROUSEL:S(e,t);break;case a.VIDEO_PAGE:h(e,t)}},m=async()=>{let e=document.querySelectorAll("tolstoy-block");if(0!==e.length)for(let t of Array.from(e)){let{publishId:e,blockType:o,navType:n,height:r}=t.dataset||{},s={blockType:o,navType:n,height:r},i="";switch(o){case a.PDP_CAROUSEL:i=y(e);break;case a.VIDEO_PAGE:i=g(e)}i&&(t.outerHTML=i,T(t,s))}};var I=r("xb7kn"),N=r("2Aomz"),w=r("kCbDV"),_=r("ljwIw"),A=r("lY4N9"),w=r("kCbDV"),b=r("fgRdL"),v=r("2S3LN"),C=r("4lhba");let L="data-status",R=[w.COLLECTION_TILE_EMBED_WIDGET],O={loading:"loading",loaded:"loaded",failed:"notFound"},P=({element:e,callback:t,outOfViewCallback:o})=>{let n=new window.IntersectionObserver(r=>{!0===r[0].isIntersecting&&r[0].intersectionRatio>.9?(o||n.unobserve(e),t()):r[0].intersectionRatio<.1&&o?.()},{threshold:[.1,.9]});n.observe(e)},M=e=>{let t=e.attributes,o={};for(let e of t)o[e.name]=e.value;return o};var x=class{constructor({name:e,component:t,elementClassname:o,preloadedConfigs:n}){this.name=e,this.Component=t,this.widgets=[],this.initialized=!1,this.elementClassname=o,this.preloadedConfigs=Array.isArray(n)?n:[],this.initAdditionalTemplates()}async init(){let e=this.getElements();if(0!==e.length){for(let t of e)if(this.getShouldInitializeElement(t)){this.setElementStatus(t,O.loading);try{let e=new this.Component;if(await e.init(t,this.preloadedConfigs.find(e=>e.projectId===t.dataset.projectId)),!e.getIsInitialized()){this.setElementStatus(t,O.failed);continue}this.widgets.push(e),this.initializeEvents({element:t,widget:e}),this.setElementStatus(t,O.loaded)}catch(e){this.setElementStatus(t,O.failed),console.log(`error starting  tolstoy ${this.name}`,t.id,e)}}this.widgets.length>0&&(this.initialized=!0)}}deleteElementStatus(e){delete e.removeAttribute(L)}getElementStatus(e){return e.getAttribute(L)}getIsTolstoyPreview(){return window.tolstoyPreview}getIsElementHidden(e){return window.getComputedStyle(e)?.display==="none"||!e.offsetParent}setElementStatus(e,t){return e.setAttribute(L,t)}getShouldInitializeElement(e){return!!e.classList.contains(b.PUBLIC_CLASS)&&!this.getElementStatus(e)||!this.getElementStatus(e)&&!this.getIsElementHidden(e)||!this.getElementStatus(e)&&(0,A.getIsTapcart)()||this.getIsTolstoyPreview()}setComponent(e){this.Component=e}initAdditionalTemplates(){if(w.COLLECTION_TILE_EMBED_WIDGET===this.name&&this.preloadedConfigs?.length&&!document.querySelector(`.${C.PUBLIC_CLASSES.collectionTile}`)){let e=[...document.querySelectorAll("img")].map(e=>({element:e,attrs:M(e)}));this.preloadedConfigs.forEach(({config:t,project:o,collectionId:n})=>{t&&o&&n&&Object.entries(t?.productsMap||{}).forEach(([t,r])=>{if(!r?.image?.src)return;let s=new URL(r.image.src).pathname.split("/").pop().split(".").slice(0,-1).join("."),i=e.find(({attrs:e})=>Object.values(e).some(e=>e.includes(s)))?.element;if(i){let e=document.createElement("div");e.innerHTML=`<tolstoy-collection-tile
                style="z-index:1"
                data-collection-id="${n}"
                class="${C.PUBLIC_CLASSES.collectionTile}"
                data-publish-id="${o.publishId}"
                data-product-id="${t}"
              ></tolstoy-collection-tile>`,i.parentElement.insertBefore(e.firstChild,i)}})})}}getElements(){return R.includes(this.name)?[document.querySelector(`.${this.elementClassname}`)].filter(Boolean):[...document.querySelectorAll(`.${this.elementClassname}`)]}shouldLoad(){return this.getElements().length>0}initializeEvents({element:e,widget:t}){t.handlePageView?.(),this.registerEmbedViewListener({element:e,callback:t.handleView,outOfViewCallback:t.handleOutOfView})}registerEmbedViewListener({element:e,callback:t,outOfViewCallback:o}){(!(0,v.getIsElementVisible)({element:e})||(t(),o))&&P({element:e,callback:t,outOfViewCallback:o})}},D=r("519R9"),U=r("aEodP");let V=!1,k=async()=>{V||((await r("e7CwX")).initializeWidgetEvents(),V=!0)};var B=class{constructor(){this.domUpdatesListenerInitialized=!1,this.widgets=[],this.embedWidgetsMap={}}async init(e){let t=[];for(let o of[w.CAROUSEL_EMBED_WIDGET,w.STORY_EMBED_WIDGET,w.EMBED_WIDGET,w.TILE_EMBED_WIDGET,w.COLLECTION_TILE_EMBED_WIDGET]){let n=w.EMBED_WIDGETS_CLASSNAMES[o],r=new x({name:o,elementClassname:n,preloadedConfigs:e});this.embedWidgetsMap[o]={embedWidget:r,loaded:!1},t.push(n)}this.registerDomUpdatesListenerIfNeeded(t),this.subscribeToUrlChange(),await this.loadEmbedWidgets()}loadEmbedWidgets=async()=>{let e=Object.entries(this.embedWidgetsMap).map(async([e,{embedWidget:t,loaded:o,loading:n}])=>{if(t.shouldLoad()){if(n){setTimeout(()=>this.loadEmbedWidgets(),2e3);return}o||await this.loadEmbedWidget({embedWidgetName:e,embedWidget:t}),await t.init()}});await Promise.all(e)};async loadEmbedWidget({embedWidgetName:e,embedWidget:t}){let o;switch(this.embedWidgetsMap[e].loading=!0,e){case w.CAROUSEL_EMBED_WIDGET:o=await r("krrJN");break;case w.STORY_EMBED_WIDGET:o=await r("fGHMu");break;case w.EMBED_WIDGET:o=await r("bjM0J");break;case w.TILE_EMBED_WIDGET:o=await r("bqpZk");break;case w.COLLECTION_TILE_EMBED_WIDGET:o=await r("kzluS");break;case w.COLLECTION_PAGE_TILE_EMBED_WIDGET:o=await r("dtdnN")}t.setComponent(o.default),await k(),this.embedWidgetsMap[e].loaded=!0,this.embedWidgetsMap[e].loading=!1}registerDomUpdatesListenerIfNeeded(e){this.domUpdatesListenerInitialized||((0,_.registerDomUpdatesListener)({classNames:e,callback:()=>this.loadEmbedWidgets()}),this.domUpdatesListenerInitialized=!0)}handleUrlChange=()=>{for(let e of Object.keys(this.embedWidgetsMap))this.embedWidgetsMap[e].loaded=!1;this.loadEmbedWidgets()};subscribeToUrlChange(){(0,D.default).subscribe({eventName:U.INTERNAL_EVENTS.urlChange,callback:this.handleUrlChange})}},H=r("eSOI5"),w=r("kCbDV"),H=r("eSOI5"),w=r("kCbDV");let F=w.BUBBLE_WIDGET,$=new Set(["5bzilmwoe1fon","z7uu0kcyzumt0"]),Y=e=>$.has(e)?w.CENTERED_MODAL_WIDGET:F,W=(e,t)=>e.find(e=>e.name===t);var G=class{constructor(){this.initialized=!1,this.widgets=[],this.start=this.start.bind(this),this.startPart=this.startPart.bind(this),this.hide=this.hide.bind(this),this.show=this.show.bind(this),this.on=this.on.bind(this),this.recreate=this.recreate.bind(this),window.tolstoyWidget={...window.tolstoyWidget,start:this.start,startPart:this.startPart,show:this.show,hide:this.hide,on:this.on,recreate:this.recreate}}async init({bubbleSettings:e,widgetId:t,Component:o}){this.bubbleSettings=e;let n=new o(e);if(await n.init(),this.widgets.push(n),this.updateViewerIdentifyAttributes(),window.tolstoySettings?.noReload||this.registerEvents(),(window.tolstoySettings?.alwaysShow||"true"!==(0,H.getTolstoyHideWidget)(t))&&!e.exitIntentPublishId){let e=Y(t);this.show(e),this.recreate(t,e)}else this.hide()}updateViewerIdentifyAttributes(){let e=Number((0,H.getSessionCounter)()||0)+1;(0,H.setSessionCounter)(e.toString()),(0,H.getFirstSeenAt)()||(0,H.setFirstSeenAt)(new Date().toISOString())}handleMouseDown(){this.userInteracted=!0,document.removeEventListener("mousedown",this.handleMouseDown)}registerEvents(){document.addEventListener("mousedown",()=>{this.handleMouseDown()}),document.body.addEventListener("mouseleave",async()=>{let e=this.bubbleSettings?.exitIntentPublishId;if(e&&this.userInteracted){let t=this.widgets.find(e=>e?.bubbleSettings?.exitIntentPublishId);t&&await this.recreate(e,t.name,{startPlayerImmediately:!0})}})}start(e=F){let t=W(this.widgets,e);t&&t.start()}startPart(e,t=F){let o=W(this.widgets,t);o&&o.startPart(e)}hide(e=F){let t=W(this.widgets,e);t&&t.hide()}show(e=F){let t=W(this.widgets,e);t&&t.show()}on(e,t,o=F){let n=W(this.widgets,o);n&&n.eventChange(e,t)}recreate(e,t=F,o={}){let n=W(this.widgets,t);n&&n.recreate(e,o)}},j=r("a78DZ"),K=r("6QfcD"),z=r("izL3O"),q=r("7Tj0o"),X=r("kK0IS"),Z=r("i1NbZ"),X=r("kK0IS"),K=r("6QfcD"),Q=r("k3iEx"),J=r("93NPo"),j=r("a78DZ"),z=r("izL3O");class ee{constructor(){if(ee.instance)return ee.instance;ee.instance=this,this.appKey=(0,K.getAppKey)(),this.shop=window.Shopify?.shop||(0,z.getShop)(),this.accountSettings=null,this.rules=new j.default,this.shouldUseCache=null,this.cacheVersion=null,this.hasLiveBubble=null}async init(){if(this.appKey||this.shop){if(this.accountSettings)return this.accountSettings;try{this.accountSettings=await (0,X.getAccountSettings)(),this.rules.updateRules(this.accountSettings),(this.accountSettings?.shouldUseCache||(0,Z.getShouldUseCache)())&&(window.tolstoySettings=window.tolstoySettings||{},window.tolstoySettings.shouldUseCache=!0);let e=this.accountSettings?.cacheVersion||(0,Z.getCacheVersion)();return e&&(window.tolstoySettings=window.tolstoySettings||{},window.tolstoySettings.cacheVersion=e),this.hasLiveBubble=this.accountSettings?.hasLiveBubble||!!window.tolstoyWidgetId||(0,Q.getTolstoyAutoOpen)(),this.accountSettings}catch(e){return(0,J.logDevelopmentError)("Error loading account settings",e),null}}}}let et=new ee;var D=r("519R9"),U=r("aEodP"),eo=class{constructor(){this.account=et,this.rules=new j.default,this.appKey=(0,K.getAppKey)()}getBubbleSettings=async()=>{let e=window.location.href,t=window.Shopify?.shop||(0,z.getShop)();if(!this.appKey&&!t)return;let o=(0,H.getIdentifyInfoId)(),n=this.rules.getTolstoyViewers(),r=t||window.location.host,s={timestamp:Date.now(),url:e,sessionCount:Number((0,H.getSessionCounter)()||0),lastSeenAt:new Date().toISOString(),firstSeenAt:(0,H.getFirstSeenAt)(),tolstoySeenCounter:n,isMobile:(0,q.default).isMobile(),domain:r,appUrl:t,appKey:this.appKey};o&&(s.identifyInfoId=o);try{let e=await (0,X.getBubbleSettings)(s);if(!e)return null;return this.rules.updateRules(e),e}catch{return null}};init=async()=>{let e;if(!this.account?.hasLiveBubble)return;let t=await this.getBubbleSettings();this.subscribeToUrlChange();let o=window.tolstoyWidgetId||t?.publishId||t?.exitIntentPublishId;if(!o){this.widget?.hide?.();return}if(!window.tolstoySettings?.alwaysShow&&"true"===(0,H.getTolstoyHideWidget)(o))return;let n=Y(o);n===w.CENTERED_MODAL_WIDGET?e=await r("enQtM"):n===w.BUBBLE_WIDGET&&(e=await r("bQxIb")),await k(),this.widget?(this.widget.recreate(o,n),this.widget.show()):(this.widget=new G,await this.widget.init({bubbleSettings:t,widgetId:o,Component:e.default}))};handleUrlChange=()=>{this.unsubscribeFromUrlChange(),this.init()};subscribeToUrlChange(){(0,D.default).subscribe({eventName:U.INTERNAL_EVENTS.urlChange,callback:this.handleUrlChange})}unsubscribeFromUrlChange(){(0,D.default).unsubscribe({eventName:U.INTERNAL_EVENTS.urlChange,callback:this.handleUrlChange})}},en=r("5GzNL"),_=r("ljwIw"),er=class{constructor(){this.domUpdatesListenerInitialized=!1,this.loaded=!1}async init(){await this.loadVideo(),this.loaded||this.registerDomUpdatesListenerIfNeeded()}async loadVideo(){let e=document.querySelector(`#${en.TOLSTOY_TV_CONTAINER_ID}`);e&&(new(await r("6TwUM")).default({tolstoyContainer:e}).init(),this.loaded=!0)}registerDomUpdatesListenerIfNeeded(){if(this.domUpdatesListenerInitialized)return;let e=[en.PUBLIC_CLASSES.tvContainer];(0,_.registerDomUpdatesListener)({classNames:e,callback:()=>this.loadVideo()}),this.domUpdatesListenerInitialized=!0}},U=r("aEodP");let es=[U.INTERNAL_EVENTS.urlChange];var i=r("aQK74"),U=r("aEodP");let ei=e=>e.data.eventName===U.INTERNAL_EVENTS.urlChange?(0,i.sendPageVisitEvent)():null;var K=r("6QfcD");let ea=["(+https://whatis.contentkingapp.com)","Shopify-Observe-Synthetic-Checks","+http://www.google.com/bot.html","https://naver.me/spd","HeadlessChrome","(+http://www.facebook.com/externalhit_uatext.php)","Bytespider","bot"],el=()=>ea.some(e=>window.navigator.userAgent.includes(e));var ed=r("dEa8z"),ec=r("kHyIS"),U=r("aEodP"),D=r("519R9"),ec=r("kHyIS");let eu=({eventName:e,callback:t})=>{if(!(0,ec.ALLOWED_EXTERNAL_EVENTS_TO_SUBSCRIBE).includes(e)){console.error(`Event ${e} is not a valid event`);return}if(!t){console.error("Callback must be provided");return}if("function"!=typeof t){console.error("Callback must be a function");return}return!0};class ep extends ed.default{constructor(){if(ep.instance)return ep.instance;super({shouldIncludeLogs:!0}),ep.instance=this}eventHandler=({data:e={}})=>{let{eventName:t}=e;if(this.eventCallbacks[t])for(let o of this.eventCallbacks[t])try{o(e)}catch(e){console.error(e)}};subscribe=(e,t,o={})=>{if(eu({eventName:e,callback:t}))try{super.subscribe({eventName:e,callback:t}),(0,D.default).postMessage({eventName:U.INTERNAL_EVENTS.externalEventSubscribed,subscribedEventName:e,payload:o});let n=new CustomEvent("TOLSTOY_WIDGET_V2_SUBSCRIBE",{detail:{eventName:e,payload:o,callback:t}});window.dispatchEvent(n),console.log("Subscribed to event",e)}catch(e){console.error(e)}};unsubscribe=(e,t)=>super.unsubscribe({eventName:e,callback:t});initInternalMessagingSubscriptions=()=>{(0,D.default).subscribeMultipleEvents({eventNames:ec.ALLOWED_EXTERNAL_EVENTS_TO_SUBSCRIBE,callback:this.eventHandler})};init(){this.initInternalMessagingSubscriptions(),this.initListener(this.eventHandler)}}let eE=new ep;Object.freeze(eE);var K=r("6QfcD"),X=r("kK0IS"),U=r("aEodP"),ec=r("kHyIS"),D=r("519R9"),H=r("eSOI5");let eh=e=>{let{eventName:t}=e;if(!t){console.error("eventName is required");return}if(!(0,ec.ALLOWED_EXTERNAL_EVENTS_TO_POST).has(t)){console.error(`${t} is not a valid eventName`);return}return!0},eg=new class{postMessage=(e={})=>{eh(e)&&(0,D.default).postMessage(e)};closePlayer(){(0,D.default).postMessage({eventName:U.INTERNAL_EVENTS.closePlayer})}changeEmail(e){window.tolstoyUser=e,(0,D.default).postMessage({eventName:U.INTERNAL_EVENTS.userEmailUpdate,email:e})}async identify(e={}){let{email:t,userId:o}=e;if(!t&&!o){console.error("No email or userId");return}try{t&&this.changeEmail(t),o&&(e.userId=o.toString()),e.appKey=(0,K.getAppKey)();let n=await (0,X.postUserIdentification)(e);(0,H.setIdentifyInfoId)(n?.id)}catch(e){console.error("Error occurred while updating identify info:",e),window.tolstoyCaptureError?.(e,"Error occurred while updating identify info:"),(0,H.removeIdentifyInfoId)()}}};Object.freeze(eg);var D=r("519R9"),U=r("aEodP"),D=r("519R9"),ec=r("kHyIS");let ef=[ec.EXTERNAL_EVENTS_TO_POST.urlLocaleUpdate];var U=r("aEodP"),ec=r("kHyIS"),D=r("519R9");let eS=({data:e})=>{if(e.eventName!==ec.EXTERNAL_EVENTS_TO_POST.urlLocaleUpdate)return null;{let{payload:t}=e;(0,D.default).postMessage({eventName:U.INTERNAL_EVENTS.urlLocaleUpdate,urlLocale:t.urlLocale})}};class ey{constructor(){if(ey.instance)return ey.instance;ey.instance=this}initExternalMessagingSubscriptions(){(0,D.default).subscribeMultipleEvents({eventNames:ef,callback:eS})}init(){this.initExternalMessagingSubscriptions();let e=window.history.pushState,t=window.history.replaceState,o=window.location.href,n=()=>{window.location.href!==o&&(o=window.location.href,(0,D.default).postMessage({eventName:U.INTERNAL_EVENTS.urlChange}))};window.history.pushState=function(){e.apply(window.history,arguments),n()},window.history.replaceState=function(){t.apply(window.history,arguments),n()}}}let eT=new ey;Object.freeze(eT);var U=r("aEodP"),D=r("519R9"),U=r("aEodP");let em=[U.INTERNAL_EVENTS.modalOpen],eI=new class{sendIsAfterpayAppInstalledMessage(){(0,D.default).postMessage({eventName:U.INTERNAL_EVENTS.isAfterpayAppInstalled,value:!!window?.Afterpay})}internalMessagingHandler=e=>{if(e.data.eventName===U.INTERNAL_EVENTS.modalOpen){this.sendIsAfterpayAppInstalledMessage();return}return null};initInternalMessagingSubscriptions(){(0,D.default).subscribeMultipleEvents({eventNames:em,callback:this.internalMessagingHandler})}init(){this.initInternalMessagingSubscriptions()}};Object.freeze(eI);var ec=r("kHyIS"),D=r("519R9"),eN=r("lxjfR"),ew=r("hlJEM"),U=r("aEodP"),D=r("519R9");let e_=()=>{(0,eN.removeAllTolstoyKeysFromStorage)(),(0,eN.setCookiePolicy)(ew.COOKIE_POLICIES.rejected),(0,D.default).postMessage({eventName:U.INTERNAL_EVENTS.rejectCookiePolicy})},eA=[ec.EXTERNAL_EVENTS_TO_POST.rejectCookiePolicy];class eb{constructor(){if(eb.instance)return eb.instance;eb.instance=this}externalMessagingHandler=e=>e.data.eventName===ec.EXTERNAL_EVENTS_TO_POST.rejectCookiePolicy?e_():null;initExternalMessagingSubscriptions=()=>{(0,D.default).subscribeMultipleEvents({eventNames:eA,callback:this.externalMessagingHandler})};init(){this.initExternalMessagingSubscriptions()}}let ev=new eb;Object.freeze(ev);var ec=r("kHyIS"),D=r("519R9"),U=r("aEodP");let eC={tolstoyAnonymousId:"__tolstoyAnonymousId"};var ec=r("kHyIS"),U=r("aEodP"),D=r("519R9");let eL=({description:e})=>"itemSoldOut"===e?U.INTERNAL_EVENTS.addToCartSoldOut:U.INTERNAL_EVENTS.addToCartError,eR=({data:e})=>{let{description:t}=e,o=eL({description:t});(0,D.default).postMessage({...e,eventName:o})},eO=({data:e})=>{let{variantId:t,productId:o,transmissionId:n,quantity:r,productHandle:s,templateSuffix:i}=e;(0,D.default).postMessage({variantId:t,productId:o,transmissionId:n,quantity:r,productHandle:s,eventName:ec.EXTERNAL_EVENTS_TO_SUBSCRIBE.addToCart,templateSuffix:i})},eP=({data:e})=>{let{product:t,transmissionId:o}=e;(0,D.default).postMessage({product:t,transmissionId:o,eventName:ec.EXTERNAL_EVENTS_TO_SUBSCRIBE.spotlightCarouselQuickShopClick})},eM=({data:e})=>{let{subscribedEventName:t,payload:o={}}=e,{disableDefault:n}=o;switch(t){case ec.EXTERNAL_EVENTS_TO_SUBSCRIBE.addToCart:case ec.EXTERNAL_EVENTS_TO_SUBSCRIBE.spotlightCarouselQuickShopClick:n&&(0,D.default).postMessage({eventName:U.INTERNAL_EVENTS.addToCartDisableDefault});break;default:return null}},ex=({data:e})=>{(0,D.default).postMessage({...e,eventName:U.INTERNAL_EVENTS.addToCartSuccess})},eD=[U.INTERNAL_EVENTS.addToCart,U.INTERNAL_EVENTS.spotlightCarouselQuickShopClick,U.INTERNAL_EVENTS.externalEventSubscribed],eU=[ec.EXTERNAL_EVENTS_TO_POST.addToCartSuccess,ec.EXTERNAL_EVENTS_TO_POST.addToCartError];class eV{constructor(){if(eV.instance)return eV.instance;eV.instance=this}internalMessagingHandler=e=>{switch(e.data.eventName){case U.INTERNAL_EVENTS.addToCart:return eO(e);case U.INTERNAL_EVENTS.spotlightCarouselQuickShopClick:return eP(e);case U.INTERNAL_EVENTS.externalEventSubscribed:return eM(e);default:return null}};externalMessagingHandler=e=>{switch(e.data.eventName){case ec.EXTERNAL_EVENTS_TO_POST.addToCartSuccess:return ex(e);case ec.EXTERNAL_EVENTS_TO_POST.addToCartError:return eR(e);default:return null}};initInternalMessagingSubscriptions=()=>{(0,D.default).subscribeMultipleEvents({eventNames:eD,callback:this.internalMessagingHandler})};initExternalMessagingSubscriptions=()=>{(0,D.default).subscribeMultipleEvents({eventNames:eU,callback:this.externalMessagingHandler})};init(){this.initInternalMessagingSubscriptions(),this.initExternalMessagingSubscriptions()}}let ek=new eV;Object.freeze(ek);var D=r("519R9"),U=r("aEodP");let eB=[U.INTERNAL_EVENTS.externalEventSubscribed,U.INTERNAL_EVENTS.productCardClick];var ec=r("kHyIS"),U=r("aEodP"),D=r("519R9");let eH=({subscribedEventName:e,payload:t})=>{if(e!==ec.EXTERNAL_EVENTS_TO_SUBSCRIBE.productCardClick)return null;{let{disableProductModal:e=!0}=t;(0,D.default).postMessage({eventName:U.INTERNAL_EVENTS.productCardClickSubscribed,isDisableProductModal:e})}},eF=({data:e})=>{let{eventName:t}=e;switch(t){case U.INTERNAL_EVENTS.externalEventSubscribed:{let{subscribedEventName:t,payload:o}=e;eH({subscribedEventName:t,payload:o});break}case U.INTERNAL_EVENTS.productCardClick:{let{variantId:t,productId:o,externalProductIds:n,productHandle:r}=e;(0,D.default).postMessage({eventName:ec.EXTERNAL_EVENTS_TO_SUBSCRIBE.productCardClick,variantId:t,productId:o,taggedProductIds:n,productHandle:r});break}default:return null}},e$=new class{initInternalMessagingSubscriptions(){(0,D.default).subscribeMultipleEvents({eventNames:eB,callback:eF})}init(){this.initInternalMessagingSubscriptions()}};Object.freeze(e$);var D=r("519R9"),U=(r("aEodP"),r("aEodP"));let eY=[U.INTERNAL_EVENTS.getProductsMetafields],eW=new class{getProductsMetafields(e=[]){let t={};for(let o of e)t[o]=window?.metafields?.products?.[o];return t}internalMessagingHandler=({data:e})=>{if(e.eventName===U.INTERNAL_EVENTS.getProductsMetafields){if(!e?.productIds?.length)return;(0,D.default).postMessage({productsExtraData:this.getProductsMetafields(e.productIds),modalId:e.modalId,eventName:U.INTERNAL_EVENTS.returnProductsMetafields});return}return null};initInternalMessagingSubscriptions(){(0,D.default).subscribeMultipleEvents({eventNames:eY,callback:this.internalMessagingHandler})}init(){this.initInternalMessagingSubscriptions()}};Object.freeze(eW);var U=r("aEodP"),D=r("519R9"),U=r("aEodP");let eG=[U.INTERNAL_EVENTS.openRebuyCart],ej={show:"rebuy:smartcart.show",hide:"rebuy:smartcart.hide",init:"rebuy:smartcart.init"},eK=new class{sendIsRebuyAppInstalledMessage=()=>{if(!window?.Rebuy?.SmartCart){document.addEventListener(ej.init,this.sendIsRebuyAppInstalledMessage,{once:!0});return}(0,D.default).postMessage({eventName:U.INTERNAL_EVENTS.isRebuyAppInstalled,value:!!window?.Rebuy?.SmartCart}),this.initRebuyEventListeners()};internalMessagingHandler=e=>e.data.eventName===U.INTERNAL_EVENTS.openRebuyCart?window?.Rebuy?.SmartCart?.show():null;initInternalMessagingSubscriptions(){(0,D.default).subscribeMultipleEvents({eventNames:eG,callback:this.internalMessagingHandler})}initRebuyEventListeners(){document.addEventListener(ej.show,()=>{(0,D.default).postMessage({eventName:U.INTERNAL_EVENTS.rebuyCartShown})}),document.addEventListener(ej.hide,()=>{(0,D.default).postMessage({eventName:U.INTERNAL_EVENTS.rebuyCartHidden})})}init(){this.initInternalMessagingSubscriptions(),this.sendIsRebuyAppInstalledMessage()}};Object.freeze(eK);var U=r("aEodP"),D=r("519R9"),U=r("aEodP");let ez=[U.INTERNAL_EVENTS.openKendoModal],eq=new class{internalMessagingHandler=e=>{if(e.data.eventName===U.INTERNAL_EVENTS.openKendoModal){(0,D.default).postMessage({eventName:U.INTERNAL_EVENTS.changeZIndex,zIndex:1e3}),window.KENDO?.openQuickModalByHandle?.(e.data.productHandle);let t=e.data.quantity;if(t<=1)return;for(let e=1;e<t;e++)setTimeout(()=>{let e=document.querySelector(".quantity-selector__action--increment");e?.click?.()},1e3+150*e);return}return null};initInternalMessagingSubscriptions(){(0,D.default).subscribeMultipleEvents({eventNames:ez,callback:this.internalMessagingHandler})}init(){this.initInternalMessagingSubscriptions()}};Object.freeze(eq);var U=r("aEodP"),D=r("519R9"),A=r("lY4N9"),X=r("kK0IS"),K=r("6QfcD"),U=r("aEodP"),D=r("519R9"),A=r("lY4N9"),U=r("aEodP");let eX=[U.INTERNAL_EVENTS.addToCart,U.INTERNAL_EVENTS.playerReady,U.INTERNAL_EVENTS.productCardClick],eZ=({productId:e,variantId:t})=>{let o={productId:String(e)};return t&&(o.variantId=String(t)),window.Tapcart.actions.openProduct(o)},eQ=e=>{let t=setTimeout(()=>{(0,D.default).postMessage({...e,eventName:U.INTERNAL_EVENTS.addToCartError})},4e3);window.Tapcart.registerEventHandler("cart/updated",()=>{clearTimeout(t),(0,D.default).postMessage({...e,eventName:U.INTERNAL_EVENTS.addToCartSuccess})})},eJ=async e=>{let{variantId:t,productId:o}=e;try{eQ(e),window.Tapcart.actions.addToCart({lineItems:[{variantId:String(t||o),quantity:1}]})}catch(t){return(0,D.default).postMessage({...e,error:t,eventName:U.INTERNAL_EVENTS.addToCartError})}},e0=()=>{try{let e=(0,A.getTapcartDeviceId)();if(!e)return;let t=[...window?.Tapcart?.variables?.cart?.attributes||[],{key:eC.tolstoyAnonymousId,value:e}];window?.Tapcart?.actions?.updateCartAttributes?.({attributes:t})}catch(e){(0,X.createPlayerEvent)({text:e?.message,parentUrl:window.location.href,appKey:(0,K.getAppKey)(),source:"tapcart",eventName:"widgetError",timestamp:new Date().toISOString()})}},e1=new class{disableCartDefault(){(0,D.default).postMessage({eventName:U.INTERNAL_EVENTS.addToCartDisableDefault})}internalMessagingHandler=e=>{switch(e.data.eventName){case U.INTERNAL_EVENTS.playerReady:return this.disableCartDefault();case U.INTERNAL_EVENTS.productCardClick:return eZ(e.data);case U.INTERNAL_EVENTS.addToCart:return eJ(e.data);default:return null}};initInternalMessagingSubscriptions(){(0,D.default).subscribeMultipleEvents({eventNames:eX,callback:this.internalMessagingHandler})}init(){(0,A.getIsTapcart)()&&(this.initInternalMessagingSubscriptions(),e0())}};Object.freeze(e1);var _=r("ljwIw"),J=r("93NPo"),Z=r("i1NbZ"),A=r("lY4N9"),U=r("aEodP");let e2={USD:"$",CAD:"CA$",EUR:"€",AED:"د.إ.‏",AFN:"؋",ALL:"Lek",AMD:"դր.",ARS:"$",AUD:"AU$",AZN:"ман.",BAM:"KM",BDT:"৳",BGN:"лв.",BHD:"د.ب.‏",BIF:"FBu",BND:"$",BOB:"Bs",BRL:"R$",BWP:"P",BYN:"руб.",BZD:"$",CDF:"FrCD",CHF:"CHF",CLP:"$",CNY:"CN¥",COP:"$",CRC:"₡",CVE:"CV$",CZK:"Kč",DJF:"Fdj",DKK:"kr",DOP:"RD$",DZD:"د.ج.‏",EEK:"kr",EGP:"ج.م.‏",ERN:"Nfk",ETB:"Br",GBP:"£",GEL:"GEL",GHS:"GH₵",GNF:"FG",GTQ:"Q",HKD:"$",HNL:"L",HRK:"kn",HUF:"Ft",IDR:"Rp",ILS:"₪",INR:"₹",IQD:"د.ع.‏",IRR:"﷼",ISK:"kr",JMD:"$",JOD:"د.أ.‏",JPY:"￥",KES:"Ksh",KHR:"៛",KMF:"FC",KRW:"₩",KWD:"د.ك.‏",KZT:"тңг.",LBP:"ل.ل.‏",LKR:"SL Re",LTL:"Lt",LVL:"Ls",LYD:"د.ل.‏",MAD:"د.م.‏",MDL:"MDL",MGA:"MGA",MKD:"MKD",MMK:"K",MOP:"MOP$",MUR:"MURs",MXN:"MX$",MYR:"RM",MZN:"MTn",NAD:"N$",NGN:"₦",NIO:"C$",NOK:"kr",NPR:"नेरू",NZD:"$",OMR:"ر.ع.‏",PAB:"B/.",PEN:"S/.",PHP:"₱",PKR:"₨",PLN:"zł",PYG:"₲",QAR:"ر.ق.‏",RON:"RON",RSD:"дин.",RUB:"₽.",RWF:"FR",SAR:"ر.س.‏",SDG:"SDG",SEK:"kr",SGD:"$",SOS:"Ssh",SYP:"ل.س.‏",THB:"฿",TND:"د.ت.‏",TOP:"T$",TRY:"TL",TTD:"$",TWD:"NT$",TZS:"TSh",UAH:"₴",UGX:"USh",UYU:"$",UZS:"UZS",VEF:"Bs.F.",VND:"₫",XAF:"FCFA",XOF:"CFA",YER:"ر.ي.‏",ZAR:"R",ZMK:"ZK",ZWL:"ZWL$"};var K=r("6QfcD"),H=r("eSOI5"),w=r("kCbDV"),D=r("519R9"),J=r("93NPo"),e9=r("k6zg1"),U=r("aEodP");let e5=[U.INTERNAL_EVENTS.addToCartDisableDefault,U.INTERNAL_EVENTS.setAnonymousIdToCart,U.INTERNAL_EVENTS.loginWithMultipassUrlRequest,U.INTERNAL_EVENTS.cartItemQuantityChange,U.INTERNAL_EVENTS.cartDataRequest,U.INTERNAL_EVENTS.productRecommendationsRequest,U.INTERNAL_EVENTS.requestProductsUpdate,U.INTERNAL_EVENTS.blockAnonymousIdToCart],e6=[U.INTERNAL_EVENTS.addToCart,U.INTERNAL_EVENTS.spotlightCarouselQuickShopClick],e3=e=>({headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(e)}),e8=!1,e4=!1,e7={},te={};class tt{constructor(){if(tt.instance)return tt.instance;tt.instance=this,this.isShopifyStore=!!(window.Shopify?.shop&&window.Shopify?.routes),this.storeRootUrl=window.Shopify?.routes?.root}getIsProductSoldOutError(e){return e.includes("already sold out")}getIsSellingPlanError(e){return e.includes("Variant can only be purchased with a selling plan.")}formatProduct(e){if(!e)return null;let t=window.Shopify?.currency?.active||window.Shopify?.currency,o=window.tolstoyCurrencySymbol||e2[t];return{...e,id:String(e.id),price:e.price/100,compare_at_price:e.compare_at_price?e.compare_at_price/100:e.compare_at_price,currencyCode:t,currencySymbol:o,variants:e.variants.map(e=>({...e,price:e.price/100,compare_at_price:e.compare_at_price?e.compare_at_price/100:e.compare_at_price}))}}async fetchRawProduct(e){let t=this.storeRootUrl+`products/${e}.js`;try{let e=await fetch(t),o=await e.json();return this.formatProduct(o)}catch{}}getProduct=async e=>{if(e7[e])return e7[e];if(te[e])return te[e];let t=this.fetchRawProduct(e);te[e]=t;let o=await t;return e7[e]=o,delete te[e],o};onRequestProductsUpdateMessage=async({handles:e})=>{let t=[...new Set(e)].map(e=>this.getProduct(e));for(let e of(await Promise.all(t)).filter(Boolean))(0,D.default).postMessage({eventName:U.INTERNAL_EVENTS.productUpdateResponse,product:e,isProductUpdateResponse:!0})};async handleSellingPlanError(e,t){let o=await this.getProduct(t);if(!o)return;let{id:n}=o.selling_plan_groups[0].selling_plans[0];return this.shopifyAddToCart({variantId:e,productHandle:t,sellingPlanId:n})}handleAddToCartError({error:e,variantId:t,productHandle:o,transmissionId:n}){let{description:r}=e;if(this.getIsProductSoldOutError(r)){(0,D.default).postMessage({eventName:U.INTERNAL_EVENTS.addToCartSoldOut,variantId:t,transmissionId:n});return}if(this.getIsSellingPlanError(r))return this.handleSellingPlanError(t,o);(0,D.default).postMessage({eventName:U.INTERNAL_EVENTS.addToCartError,error:r,variantId:t,transmissionId:n})}handleUpdateItemQuantityError({error:e,variantId:t,transmissionId:o}){let{description:n}=e;(0,D.default).postMessage({eventName:U.INTERNAL_EVENTS.cartItemQuantityChangeError,error:n,variantId:t,transmissionId:o})}async getCart({transmissionId:e}){try{let t=await fetch(`${this.storeRootUrl}cart.js`,{method:"GET"}),o=await t.json();(0,D.default).postMessage({eventName:U.INTERNAL_EVENTS.cartDataResponse,cart:o,transmissionId:e})}catch{}}triggerExternalCartUpdate(){window.VueMiniCart?.$store?._actions?.initCart?.[0]?.(),window.slate?.cart?.reloadCart?.(),window.tolstoyCartRefresh?.(),window.monster_refresh?.(),window.updateMiniCart?.()}disableAddToCart(){e8=!0,(0,D.default).unsubscribeMultipleEvents({eventNames:e6,callback:this.internalMessagingHandler})}postUrlLocaleUpdateIfNeeded(){window.Shopify?.routes?.root!=="/"&&(0,D.default).postMessage({eventName:U.INTERNAL_EVENTS.urlLocaleUpdate,urlLocale:window.Shopify?.routes?.root})}postIsNonBaseCurrencyIfNeeded(){(0,e9.getIsBaseCurrency)()||(0,D.default).postMessage({eventName:U.INTERNAL_EVENTS.isNonBaseCurrency})}shopifyQuickShopClick({product:e}){let{variants:t,handle:o,quantity:n=1}=e,r=t[0].id;return this.shopifyAddToCart({variantId:r,productHandle:o,quantity:n})}shopifyAddToCart=async({variantId:e,productHandle:t,sellingPlanId:o,quantity:n=w.DEFAULT_CART_QUANTITY,transmissionId:r})=>{let s={};e4||(s._isAddedFromTolstoy=!0);let i={id:e,quantity:n,properties:s};o&&(i.selling_plan=o);let a=e3({items:[i]});try{let o=await fetch(`${this.storeRootUrl}cart/add.js`,a);if(!o.ok){let n=await o.json();return this.handleAddToCartError({error:n,variantId:e,productHandle:t,transmissionId:r})}this.triggerExternalCartUpdate(),(0,D.default).postMessage({eventName:U.INTERNAL_EVENTS.addToCartSuccess,variantId:e,transmissionId:r,shouldEndTransmission:!1}),this.getCart({transmissionId:r})}catch(o){console.log(o),this.handleAddToCartError({error:o,variantId:e,productHandle:t,transmissionId:r})}};shopifyUpdateItemQuantity=async({variantId:e,quantity:t,transmissionId:o})=>{let n=e3({updates:{[e]:t}});try{let t=await fetch(`${this.storeRootUrl}cart/update.js`,n);if(!t.ok){let n=await t.json();return this.handleUpdateItemQuantityError({error:n,variantId:e,transmissionId:o})}this.triggerExternalCartUpdate(),(0,D.default).postMessage({eventName:U.INTERNAL_EVENTS.cartItemQuantityChangeSuccess,variantId:e,transmissionId:o,shouldEndTransmission:!1}),this.getCart({transmissionId:o})}catch(t){this.handleUpdateItemQuantityError({error:t,variantId:e,transmissionId:o})}};async getProductRecommendations({productId:e,transmissionId:t}){let o=`${this.storeRootUrl}recommendations/products.json?product_id=${e}`;try{let n=await fetch(o,{method:"GET"}),{products:r}=await n.json();(0,D.default).postMessage({eventName:U.INTERNAL_EVENTS.productRecommendationsResponse,productId:e,products:r,transmissionId:t})}catch{}}async loginWithMultipassUrl({multipassUrl:e,transmissionId:t}){try{let o=await fetch(e);(0,D.default).postMessage({eventName:U.INTERNAL_EVENTS.loginWithMultipassUrlResponse,statusCode:o.status,transmissionId:t})}catch{}}async setAnonymousIdToCart({anonymousId:e}){if("true"===(0,H.getIsShopifyCartAnonymousIdSet)()||e4||!(0,J.verifyUserConsent)())return;let t=e3({attributes:{[eC.tolstoyAnonymousId]:e}});try{await fetch(`${this.storeRootUrl}cart/update.js`,t),(0,H.setIsShopifyCartAnonymousIdSet)(!0)}catch(e){console.error(e)}}async blockAnonymousIdToCart({appKey:e}){let t=(0,H.getTolstoyInteractionDate)(e);(0,J.isNullOrUndefined)(t)||await this.setAnonymousIdToCart({anonymousId:null}),e4=!0}forceClearAnonymousIdFromCart(){if(window.Shopify?.shop!=="mlt-boutique.myshopify.com")return;let e=(0,K.getAppKey)();e&&this.blockAnonymousIdToCart({appKey:e})}internalMessagingHandler=e=>{switch(e.data.eventName){case U.INTERNAL_EVENTS.addToCart:return this.shopifyAddToCart(e.data);case U.INTERNAL_EVENTS.spotlightCarouselQuickShopClick:return this.shopifyQuickShopClick(e.data);case U.INTERNAL_EVENTS.addToCartDisableDefault:return this.disableAddToCart(e.data);case U.INTERNAL_EVENTS.blockAnonymousIdToCart:return this.blockAnonymousIdToCart(e.data);case U.INTERNAL_EVENTS.setAnonymousIdToCart:return this.setAnonymousIdToCart(e.data);case U.INTERNAL_EVENTS.loginWithMultipassUrlRequest:return this.loginWithMultipassUrl(e.data);case U.INTERNAL_EVENTS.cartItemQuantityChange:return this.shopifyUpdateItemQuantity(e.data);case U.INTERNAL_EVENTS.cartDataRequest:return this.getCart(e.data);case U.INTERNAL_EVENTS.productRecommendationsRequest:return this.getProductRecommendations(e.data);case U.INTERNAL_EVENTS.requestProductsUpdate:return this.onRequestProductsUpdateMessage(e.data);default:return null}};initInternalMessagingSubscriptions=()=>{if((0,D.default).subscribeMultipleEvents({eventNames:e5,callback:this.internalMessagingHandler}),e8){(0,J.logDevelopmentMessage)("Add to cart disabled");return}(0,D.default).subscribeMultipleEvents({eventNames:e6,callback:this.internalMessagingHandler})};init(){this.isShopifyStore&&(this.initInternalMessagingSubscriptions(),this.postUrlLocaleUpdateIfNeeded(),this.postIsNonBaseCurrencyIfNeeded(),this.forceClearAnonymousIdFromCart())}}let to=new tt;Object.freeze(to);var U=r("aEodP"),D=r("519R9");let tn=e=>({id:e.id,price:e.price,compareAtPrice:e.price,currencyCode:e.currency,currencySymbol:e2[e.currency],variants:[{price:e.price,compareAtPrice:e.price}]}),tr=(e="")=>e.replace("_","-");var U=r("aEodP");let ts=[U.INTERNAL_EVENTS.openCommerceSettingsUpdate,U.INTERNAL_EVENTS.requestProductsUpdate],ti={},ta={},tl=new class{constructor(){this.isOpenCommerceStore=!!window.CQuotient,this.siteId=window.CQuotient?.siteId,this.locale=tr(window.CQuotient?.locale),this.apiBaseUrl="",this.clientId="",this.currencyCode=window.pageContext?.ecommerce?.currencyCode}fetchProduct=async e=>{let t=new URL(`${this.apiBaseUrl}/products/${e}`);t.searchParams.append("client_id",this.clientId),t.searchParams.append("locale",this.locale),t.searchParams.append("currency",this.currencyCode),t.searchParams.append("expand","prices");try{let e=await fetch(t),o=await e.json();return tn(o)}catch(e){console.error("Error fetching product price",e)}};getProduct=async e=>{if(ti[e])return ti[e];if(ta[e])return ta[e];let t=this.fetchProduct(e);ta[e]=t;let o=await t;return ti[e]=o,delete ta[e],o};onRequestProductsUpdateMessage=async({productIds:e})=>{let t=[...new Set(e)].map(e=>this.getProduct(e));for(let e of(await Promise.all(t)).filter(Boolean))(0,D.default).postMessage({eventName:U.INTERNAL_EVENTS.productUpdateResponse,product:e,isProductUpdateResponse:!0})};postUrlLocaleUpdateIfNeeded(e){this.locale!==e&&(0,D.default).postMessage({eventName:U.INTERNAL_EVENTS.urlLocaleUpdate,urlLocale:this.locale})}postIsNonBaseCurrencyIfNeeded(e){this.currencyCode!==e&&(0,D.default).postMessage({eventName:U.INTERNAL_EVENTS.isNonBaseCurrency,currencyCode:this.currencyCode})}onOpenCommerceSettingsUpdate({openCommerceSettings:e}){let{apiVersion:t,clientId:o,baseLocale:n,baseCurrency:r}=e;this.apiBaseUrl=`https://${window.location.host}/s/${this.siteId}/dw/shop/${t}`,this.clientId=o,this.postUrlLocaleUpdateIfNeeded(n),this.postIsNonBaseCurrencyIfNeeded(r)}internalMessagingHandler=e=>{switch(e.data.eventName){case U.INTERNAL_EVENTS.openCommerceSettingsUpdate:return this.onOpenCommerceSettingsUpdate(e.data);case U.INTERNAL_EVENTS.requestProductsUpdate:return this.onRequestProductsUpdateMessage(e.data);default:return null}};initInternalMessagingSubscriptions(){(0,D.default).subscribeMultipleEvents({eventNames:ts,callback:this.internalMessagingHandler})}init(){this.isOpenCommerceStore&&this.initInternalMessagingSubscriptions()}};var D=r("519R9"),ec=r("kHyIS");let td=[ec.EXTERNAL_EVENTS_TO_POST.productUpdate],tc=["id","descriptionHtml","description_html","variants","price","compare_at_price","title"],tu=["id","price","compare_at_price","title"];var D=r("519R9"),U=r("aEodP"),ec=r("kHyIS");let tp=e=>tc.includes(e),tE=e=>Array.isArray(e)?e.flatMap((e,t)=>{let o=Object.keys(e).filter(e=>!tu.includes(e));return 0===o.length?[]:`variants[${t}]: { ${o.join(", ")} }`}):["variants (must be an array)"],th=({product:e})=>{let t=Object.keys(e).filter(e=>!tp(e));if(e.variants&&t.push(...tE(e.variants)),t.length>0){console.error(`Fields ${t.join(", ")} are not supported for product update.`);return}(0,D.default).postMessage({product:e,eventName:U.INTERNAL_EVENTS.productUpdateResponse})},tg=({data:e})=>e.eventName===ec.EXTERNAL_EVENTS_TO_POST.productUpdate?th(e):null,tf=new class{initExternalMessagingSubscriptions(){(0,D.default).subscribeMultipleEvents({eventNames:td,callback:tg})}init(){this.initExternalMessagingSubscriptions()}};Object.freeze(tf);var D=r("519R9"),ec=r("kHyIS");let tS=[ec.EXTERNAL_EVENTS_TO_POST.addToCartSuccess,ec.EXTERNAL_EVENTS_TO_POST.addToCartError];class ty{constructor(){if(ty.instance)return ty.instance;ty.instance=this}postMessageToWidgetV2=e=>{let{data:t}=e||{},{eventName:o,subscribedEventName:n}=t||{};if(!o&&!n)return;let r=new CustomEvent("TOLSTOY_WIDGET_V2_MESSAGE",{detail:{...t,eventName:n||o}});window.dispatchEvent(r)};initExternalMessagingSubscriptions=()=>{(0,D.default).subscribeMultipleEvents({eventNames:tS,callback:this.postMessageToWidgetV2})};init(){this.initExternalMessagingSubscriptions()}}let tT=new ty;Object.freeze(tT);var X=r("kK0IS"),tm=r("4dQPj"),tI=class{constructor(){this.domUpdatesListenerInitialized=!1,this.loaded=!1}async init(){}async loadVideo(){}registerDomUpdatesListenerIfNeeded(){}},tN=Object.assign(Object.create(null),{url:"file:///packages/widget/src/widgets/widgetloader.js"});let tw=()=>{let e=document.querySelector("script[data-collection-id]")?.dataset?.collectionId;return e?.includes("{{ collection.id")||!e?null:e},t_=async()=>{try{let e=(0,K.getAppKey)(),t=tw(),o=(0,Z.getParameterFromWidgetScripts)("collection-gallery-projects"),n=JSON.parse(o);if(console.log("collectionGalleryProjects",n),t&&e&&n?.length){let o=await (0,X.getCollectionTileConfigs)(e,t);if(Array.isArray(o)&&o?.length&&o.some(e=>e.project&&e.collectionId))return o}}catch(e){console.log(e)}return[]},tA=()=>{let e=document.currentScript?.src||tN?.url;if(e?.includes("/we/widget.js")){(0,_.createScript)({src:`https://${N.WIDGET_DOMAIN}/wes/widget.js`,container:document.head,attributes:{type:"module"}});return}(0,_.createScript)({src:`https://${N.WIDGET_DOMAIN}/ws/widget.js`,container:document.head})},tb=()=>!!document.body,tv=()=>{try{return window.self!==window.top}catch{return!0}},tC=()=>tv()&&"theordinary.com"===window.location.host,tL=async()=>{try{if(window.tolstoyWidget||tC())return;if(el()){console.debug("Bot user");return}if(!tb()){setTimeout(tL,50);return}if((0,A.getIsTapcart)()&&await m(),"true"===(0,J.getSafeParameter)("td")&&!document.currentScript?.src?.includes?.("/ws/widget.js")&&!tN?.url?.includes?.("/wes/widget.js")){tA();return}(0,i.registerSiteActivityListenerIfNeeded)(),tD(),tU(),tV(),tk(),tB(),tH(),(0,i.sendPageVisitEvent)();let[,e]=await Promise.all([tR(),t_()]);await Promise.all([tO(),tP(),tx(),tM(e)]),(0,I.tolstoyWidgetReady)()}catch(e){console.log("error",e)}},tR=async()=>et.init(),tO=e=>new eo(e).init(),tP=()=>new er().init(),tM=e=>new B().init(e),tx=()=>new tI().init(),tD=()=>((0,D.default).init(),D.default),tU=()=>((0,tm.default).init(),tm.default),tV=()=>{eE.init();let{subscribe:e,unsubscribe:t}=eE;return window.tolstoyWidget={...window.tolstoyWidget,subscribe:e,unsubscribe:t},eE},tk=()=>{let{postMessage:e,closePlayer:t,identify:o,changeEmail:n}=eg;return window.tolstoyWidget={...window.tolstoyWidget,postMessage:e,closePlayer:t,identify:o,changeEmail:n},eg},tB=()=>{to.init(),eT.init(),ek.init(),eK.init(),eq.init(),e1.init(),eI.init(),ev.init(),e$.init(),tl.init(),tf.init(),tT.init(),"8b32dacc-8f1d-4cce-b641-9f60e88f9414"===(0,K.getAppKey)()&&eW.init()},tH=()=>{(0,D.default).subscribeMultipleEvents({eventNames:es,callback:ei})};tL()}();